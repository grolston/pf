(()=>{"use strict";const n=require("@aws-sdk/client-organizations"),e=require("@aws-sdk/client-iam"),o=require("@aws-sdk/client-cloudformation"),i=require("@aws-sdk/client-sso-admin"),t=require("@aws-sdk/client-ec2"),a=require("@aws-sdk/client-cloudtrail"),s=require("@aws-sdk/client-config-service"),c=require("@aws-sdk/client-controltower"),r=require("@aws-sdk/client-cost-and-usage-report-service"),l=require("fs");(async()=>{const d="./Pathfinder.txt";let p=new Date;l.writeFileSync(d,"Cloud Foundations - Pathfinder"),l.appendFileSync(d,`\nGenerated on: ${p.toUTCString()} \n\n`),l.appendFileSync(d,"\n---------------------------------------------------------");const u=process.env.AWS_REGION||"us-east-1",y=await async function(){const n=new t.EC2Client({region:"us-east-1"});try{const e=new t.DescribeRegionsCommand({}),o=await n.send(e),i=[];for(const n of o.Regions||[])i.push(n.RegionName||"");return i}catch(n){return console.error("Error retrieving regions:",n),[]}finally{n.destroy()}}(),g=await(async e=>{const o=new n.OrganizationsClient({region:e});try{const e=new n.DescribeOrganizationCommand({}),i=await o.send(e),t=!!i.Organization;return i.Organization?.MasterAccountId?{isInOrganization:t,isManagementAccount:i.Organization?.MasterAccountId==i.Organization?.MasterAccountId}:{isInOrganization:t}}catch(n){return console.error("Error:",n),{isInOrganization:!1}}finally{o.destroy()}})(u);if(l.appendFileSync(d,"\n\nAWS ACCOUNT TYPE\n"),g&&(console.dir(g,{depth:null,colors:!0}),l.appendFileSync(d,`\n  Is in AWS Organization: ${g.isInOrganization}`),l.appendFileSync(d,`\n  Assessing AWS Management Account: ${g.isManagementAccount}`)),g.isInOrganization&&g.isManagementAccount){l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nLegacy CUR\n");const e=await(async n=>{const e=new r.CostAndUsageReportServiceClient({region:n});let o=!1;try{const n={},i=new r.DescribeReportDefinitionsCommand(n),t=await e.send(i);return t.ReportDefinitions&&t.ReportDefinitions.length>0&&(o=!0),{isLegacyCurSetup:o}}catch(n){return console.error(`Error: ${n}`),o=!1,{isLegacyCurSetup:o}}finally{e.destroy()}})(u);console.dir(e,{depth:null,colors:!0}),l.appendFileSync(d,`\n  Is legacy CUR setup: ${e.isLegacyCurSetup}`),l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION POLICY TYPES\n");const t=await async function(e){const o=new n.OrganizationsClient({region:e});let i={scpEnabled:!1,tagPolicyEnabled:!1,backupPolicyEnabled:!1};try{const e={},t=new n.ListRootsCommand(e),a=await o.send(t);if(a.Roots&&a.Roots[0].PolicyTypes)for(const n of a.Roots[0].PolicyTypes)"SERVICE_CONTROL_POLICY"==n.Type&&"ENABLED"==n.Status&&(i.scpEnabled=!0),"TAG_POLICY"==n.Type&&"ENABLED"==n.Status&&(i.tagPolicyEnabled=!0),"BACKUP_POLICY"==n.Type&&"ENABLED"==n.Status&&(i.backupPolicyEnabled=!0)}catch(n){console.error(`An error occurred: ${n}`)}finally{return o.destroy(),i}}(u);console.dir(t,{depth:null,colors:!0}),l.appendFileSync(d,`\n  Service Control Policies (SCP) enabled: ${t.scpEnabled}`),l.appendFileSync(d,`\n  Tag Policies enabled: ${t.tagPolicyEnabled}`),l.appendFileSync(d,`\n  Backup Policies enabled: ${t.backupPolicyEnabled}`),l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION ENABLED SERVICES\n");const a=await async function(e){const o=[],i=new n.OrganizationsClient({region:e});try{const e=new n.ListAWSServiceAccessForOrganizationCommand({}),t=await i.send(e);if(t.EnabledServicePrincipals&&t.EnabledServicePrincipals.length>0){t.EnabledServicePrincipals;for(const n of t.EnabledServicePrincipals){const e={service:n.ServicePrincipal??""};o.push(e)}}}catch(n){console.error("Error checking service access:",n)}finally{return i.destroy(),o}}(u);console.dir(a,{depth:null,colors:!0}),l.appendFileSync(d,"\n  The following AWS Services are enabled within your AWS Organization:");for(const n of a)l.appendFileSync(d,`\n    ${n.service}`);l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION INTEGRATED SERVICE REGISTERED DELEGATED ADMINS\n");const s=await async function(){let e=[];const o=new n.OrganizationsClient({region:"us-east-1"});let i={};try{const t=new n.ListDelegatedAdministratorsCommand({}),a=await o.send(t);if(a.DelegatedAdministrators)for(const t of a.DelegatedAdministrators){const a={AccountId:t.Id},s=new n.ListDelegatedServicesForAccountCommand(a),c=await o.send(s);c.DelegatedServices&&(i={services:c.DelegatedServices,accountName:t.Name},e.push(i))}}catch(n){console.log("Error looking for delegated services.")}finally{o.destroy()}return e}();if(console.dir(s,{depth:null,colors:!0}),s&&s.length>0)for(const n of s){if(l.appendFileSync(d,`\n  Account: ${n.accountName}`),n.services&&n.services.length>0){l.appendFileSync(d,"\n  Delegated Services:");for(const e of n.services)l.appendFileSync(d,`\n    ${e.ServicePrincipal}`)}l.appendFileSync(d,"\n ")}else l.appendFileSync(d,"\n  No delegated admin accounts in AWS Organization");l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION CLOUDFORMATION\n");const p=await async function(n){let e={status:"disabled"};const i=new o.CloudFormationClient({region:n});try{const n={},t=new o.DescribeOrganizationsAccessCommand(n),a=await i.send(t);e.status=a.Status??"disabled"}catch(n){console.log(`Error: ${n}`)}finally{return i.destroy(),e}}(u);console.dir(p,{depth:null,colors:!0}),l.appendFileSync(d,`\n  AWS CloudFormation Organization stack sets status : ${p.status}`),l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS CONTROL TOWER\n");const g=await async function(n){let e={};const o=new c.ControlTowerClient({region:n});try{const n=new c.ListLandingZonesCommand({}),i=await o.send(n);if(console.log(JSON.stringify(i.landingZones,null,2)),i.landingZones&&i.landingZones.length>0){const n={landingZoneIdentifier:i.landingZones[0].arn},o=i.landingZones[0].arn?.toString().split(":")[3]??"";if(o){e.controlTowerRegion=o;const i=new c.ControlTowerClient({region:o}),t=new c.GetLandingZoneCommand(n),a=await i.send(t);a.landingZone&&(console.log(JSON.stringify(a.landingZone,null,2)),e.status=a.landingZone.status,e.latestAvailableVersion=a.landingZone.latestAvailableVersion,e.deployedVersion=a.landingZone.version,e.driftStatus=a.landingZone.driftStatus?.status)}}}catch(e){console.error(`Error checking Control Tower in ${n}:`,e)}finally{o.destroy()}return e}(u);g?(console.dir(g,{depth:null,colors:!0}),l.appendFileSync(d,`\n  Control Tower home region: ${g.controlTowerRegion}`),l.appendFileSync(d,`\n  Control Tower status: ${g.status}`),l.appendFileSync(d,`\n  Control Tower Landing Zone version: ${g.deployedVersion}`),l.appendFileSync(d,`\n  Latest available version: ${g.deployedVersion}`),l.appendFileSync(d,`\n  Drift Status: ${g.driftStatus}`)):l.appendFileSync(d,"\n  AWS Control Tower is not deployed in the AWS Organization"),l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS IAM IDENTITY CENTER\n");const S=await async function(n){let e={found:!1};for(const o of n){const n=new i.SSOAdminClient({region:o});try{const t={MaxResults:Number("100")},a=new i.ListInstancesCommand(t),s=await n.send(a);if(s.Instances&&s.Instances.length>0){const n=s.Instances[0];e.found=!0,e.region=o,e.arn=n.InstanceArn,e.id=n.IdentityStoreId;break}}catch(n){console.log(`Error looking for AWS Identity Center details in region ${o}`)}finally{n.destroy()}}return e}(y);console.dir(S,{depth:null,colors:!0}),l.appendFileSync(d,`\n  IdC Region: ${S.region}`),l.appendFileSync(d,`\n  IdC ARN: ${S.arn}`),l.appendFileSync(d,`\n  IdC Instance Id: ${S.id}`),l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION DETAILS\n");const f=await async function(e){const o=new n.OrganizationsClient({region:e});let i={};try{const e=new n.DescribeOrganizationCommand({}),t=await o.send(e);t.Organization&&(i.id=t.Organization.Id??"",i.arn=t.Organization.Arn??"");const a=new n.ListRootsCommand({}),s=await o.send(a);s.Roots?i.rootOuId=s.Roots[0].Id:console.log("No info found for your AWS Organization.")}catch(n){console.error(`An error occurred: ${n}`)}finally{return o.destroy(),i}}(u);if(console.dir(f,{depth:null,colors:!0}),l.appendFileSync(d,`\n  AWS Organization Id: ${f.id}`),l.appendFileSync(d,`\n  AWS Organization ARN: ${f.arn}`),l.appendFileSync(d,`\n  AWS Organization Root OU Id: ${f.rootOuId}`),f.rootOuId){l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION TOP-LEVEL ORGANIZATION UNITS\n");const e=await async function(e,o){const i=new n.OrganizationsClient({region:e});let t=[];try{const e=new n.ListOrganizationalUnitsForParentCommand({ParentId:o}),a=await i.send(e);if(a.OrganizationalUnits)for(const e of a.OrganizationalUnits){let o={id:e.Id,name:e.Name};const a=await i.send(new n.ListAccountsForParentCommand({ParentId:e.Id}));a.Accounts&&a.Accounts.length>0&&(o.accounts=a.Accounts),t.push(o)}}catch(n){return console.error("Error checking service access:",n),[]}finally{i.destroy()}return t}(u,f.rootOuId);if(console.dir(e,{depth:null,colors:!0}),l.appendFileSync(d,"\n  List of Organization's top-level OUs and AWS accounts:"),e&&e.length>0)for(const n of e){if(l.appendFileSync(d,`\n    Organizational Unit: ${n.name}`),l.appendFileSync(d,`\n      Organizational Unit Id: ${n.id}`),n.accounts&&n.accounts.length>0){l.appendFileSync(d,"\n      AWS Accounts:");for(const e of n.accounts)l.appendFileSync(d,`\n        ${e.Name}`);l.appendFileSync(d,"\n")}else l.appendFileSync(d,"\n      AWS Accounts: None");l.appendFileSync(d,"\n")}else l.appendFileSync(d,"\n  No top level OUs found.")}l.appendFileSync(d,"\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n\nAWS ORGANIZATION MEMBER ACCOUNTS\n");const A=await async function(){let e=[];const o=new n.OrganizationsClient({region:"us-east-1"});try{const i=await o.send(new n.ListAccountsCommand({}));if(i.Accounts&&i.Accounts.length>0)for(const n of i.Accounts){let o={accountName:n.Name,accountEmail:n.Email};e.push(o)}}catch(n){console.error("Error listing AWS accounts:",n)}finally{o.destroy()}return e}();if(console.dir(A,{depth:null,colors:!0}),A&&A.length>0)for(const n of A)l.appendFileSync(d,`\n  Account: ${n.accountName}`),l.appendFileSync(d,`\n  Account Email: ${n.accountEmail}\n`);else l.appendFileSync(d,"No member accounts found which is amazing as this is running from one.")}else if(g.isInOrganization&&!g.isManagementAccount){const n="\nWARNING: You are running PAAT from an account that is a member of your AWS Organization. Please run the solution from your AWS Management account.";console.warn(n),l.appendFileSync(d,n)}else{const n="\nWARNING: You are running PAAT from an account that not part of an AWS Organization. This account will be treated as a standalone account.";console.warn(n),l.appendFileSync(d,n)}l.appendFileSync(d,"\n\n\n---------------------------------------------------------"),l.appendFileSync(d,"\n---------------------------------------------------------"),l.appendFileSync(d,"\nAWS MANAGEMENT ACCOUNT CHECKS"),l.appendFileSync(d,"\n---------------------------------------------------------"),l.appendFileSync(d,"\n---------------------------------------------------------\n");const S=await(async()=>{const n=new e.IAMClient({region:"us-east-1"}),o=[];try{const i=new e.ListUsersCommand({}),t=await n.send(i);for(const i of t.Users||[]){const t=i.UserName||"",a=new e.ListAccessKeysCommand({UserName:t}),s=(await n.send(a)).AccessKeyMetadata||[];if(s.length>0)for(const i of s){const a=i.AccessKeyId||"",s=new e.GetAccessKeyLastUsedCommand({AccessKeyId:a}),c=await n.send(s),r={userName:t,accessKeyId:a,lastUsed:c&&c.AccessKeyLastUsed&&`${c.AccessKeyLastUsed.LastUsedDate}`||"Not available"};o.push(r)}else{const n={userName:t};o.push(n)}}}catch(n){console.error("Error:",n)}finally{n.destroy()}return o})();if(l.appendFileSync(d,"\n\nIAM USERS CHECK\n"),S&&S.length>0){console.dir(S,{depth:null,colors:!0});for(const n of S)l.appendFileSync(d,`\n  IAM User: ${n.userName}`),n.accessKeyId&&l.appendFileSync(d,`\n    User API Key ID: ${n.accessKeyId}`),l.appendFileSync(d,"\n")}else l.appendFileSync(d,"\n  No IAM Users found.");l.appendFileSync(d,"\n\n---------------------------------------------------------");const f=await async function(n){let e=[];for(const o of n){const n=new t.EC2Client({region:o}),i=new t.DescribeInstancesCommand({});try{const t=await n.send(i);if(t.Reservations)if(t.Reservations.length>0){const n={region:o,ec2Found:!0};e.push(n)}else{const n={region:o,ec2Found:!1};e.push(n)}else{const n={region:o,ec2Found:!1};e.push(n)}}catch(n){console.log(`Error checking instance: ${n}`)}finally{n.destroy()}}return e}(y);if(l.appendFileSync(d,"\n\nEC2 INSTANCE CHECK\n"),f&&f.find((n=>!0===n.ec2Found))){console.dir(f,{depth:null,colors:!0});for(const n of f)n.ec2Found&&l.appendFileSync(d,`\n  ${n.region} - found EC2 Instance(s).`)}else l.appendFileSync(d,"\n  No EC2 instances found.");l.appendFileSync(d,"\n\n---------------------------------------------------------");const A=await async function(n){let e=[];for(const o of n){const n=new t.EC2Client({region:o}),i=new t.DescribeVpcsCommand({});try{const t=await n.send(i);if(t.Vpcs)if(t.Vpcs.length>0){const n={region:o,vpcFound:!0};e.push(n)}else{const n={region:o,vpcFound:!1};e.push(n)}else{const n={region:o,vpcFound:!1};e.push(n)}}catch(n){console.log(`Error checking instance: ${n}`)}finally{n.destroy()}}return e}(y);if(l.appendFileSync(d,"\n\nVPC CHECK\n"),A&&A.length>0){console.dir(A,{depth:null,colors:!0});for(const n of A)n.vpcFound&&l.appendFileSync(d,`\n  ${n.region} - found VPC(s).`)}else l.appendFileSync(d,"\n  No VPCs found.");l.appendFileSync(d,"\n\n---------------------------------------------------------");const F=await async function(n){let e=[];for(const o of n){const n=new a.CloudTrailClient({region:o}),i=new a.DescribeTrailsCommand({});try{const t=await n.send(i);if(t.trailList)for(const n of t.trailList){let i={};i=n.HomeRegion==o?{region:o,trailFound:!0,isOrgTrail:n.IsMultiRegionTrail,isMultiRegion:n.IsMultiRegionTrail}:{region:o,trailFound:!1},e.push(i)}}catch(n){console.log(`Error checking instance: ${n}`)}finally{n.destroy()}}return e}(y);if(l.appendFileSync(d,"\n\nCLOUDTRAIL CHECK\n"),F&&F.length>0){console.dir(F,{depth:null,colors:!0});for(const n of F)n.trailFound&&(l.appendFileSync(d,`\n  CloudTrail found in ${n.region}`),l.appendFileSync(d,`\n    Is Organization Trail: ${n.isOrgTrail}`),l.appendFileSync(d,`\n    Is MultiRegion: ${n.isMultiRegion}`),l.appendFileSync(d,"\n"))}else l.appendFileSync(d,"\n  No AWS CloudTrail resource discovered");l.appendFileSync(d,"\n"),l.appendFileSync(d,"\n\n---------------------------------------------------------");const C=await async function(n){let e=[];for(const o of n){const n=new s.ConfigServiceClient({region:o});let i={region:o,configRecorderFound:!1,configDeliveryChannelFound:!1};try{const o=await n.send(new s.DescribeConfigurationRecorderStatusCommand({}));0!==o.ConfigurationRecordersStatus?.length&&(i.configRecorderFound=!0);const t=await n.send(new s.DescribeDeliveryChannelsCommand({}));0!==t.DeliveryChannels?.length&&(i.configDeliveryChannelFound=!0),e.push(i)}catch(n){console.error(`Error checking AWS Config in ${o}:`,n)}finally{n.destroy()}}return e}(y);if(l.appendFileSync(d,"\n\nAWS CONFIG CHECK\n"),C&&C.find((n=>!0===n.configRecorderFound))){console.dir(C,{depth:null,colors:!0});for(const n of C)n.configRecorderFound&&l.appendFileSync(d,`\n  ${n.region} - Config Recorder found`),n.configDeliveryChannelFound&&l.appendFileSync(d,`\n  ${n.region} - Config Delivery Channel found`)}else l.appendFileSync(d,"\n  No AWS Config resource discovered");l.appendFileSync(d,"\n\n\n  END ASSESSMENT")})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cmdhbml6YXRpb25zXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIGNvbW1vbmpzIFwiQGF3cy1zZGsvY2xpZW50LWlhbVwiIiwid2VicGFjazovLy9leHRlcm5hbCBjb21tb25qcyBcIkBhd3Mtc2RrL2NsaWVudC1jbG91ZGZvcm1hdGlvblwiIiwid2VicGFjazovLy9leHRlcm5hbCBjb21tb25qcyBcIkBhd3Mtc2RrL2NsaWVudC1zc28tYWRtaW5cIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgY29tbW9uanMgXCJAYXdzLXNkay9jbGllbnQtZWMyXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIGNvbW1vbmpzIFwiQGF3cy1zZGsvY2xpZW50LWNsb3VkdHJhaWxcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgY29tbW9uanMgXCJAYXdzLXNkay9jbGllbnQtY29uZmlnLXNlcnZpY2VcIiIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgY29tbW9uanMgXCJAYXdzLXNkay9jbGllbnQtY29udHJvbHRvd2VyXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIGNvbW1vbmpzIFwiQGF3cy1zZGsvY2xpZW50LWNvc3QtYW5kLXVzYWdlLXJlcG9ydC1zZXJ2aWNlXCIiLCJ3ZWJwYWNrOi8vL2V4dGVybmFsIG5vZGUtY29tbW9uanMgXCJmc1wiIiwid2VicGFjazovLy8uL2J1aWxkL2FwcC5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9nZXQtcmVnaW9ucy5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9kZWZpbmUtYWNjb3VudC10eXBlLmpzIiwid2VicGFjazovLy8uL2J1aWxkL3NyYy9hY3Rpb25zL2NoZWNrLWxlZ2FjeS1jdXIuanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvZ2V0LWVuYWJsZWQtb3JnLXBvbGljeS10eXBlcy5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9nZXQtZW5hYmxlZC1vcmctc2VydmljZXMuanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvZ2V0LW9yZy1kYS1hY2NvdW50cy5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9jaGVjay1vcmctY2xvdWRmb3JtYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvY2hlY2stY29udHJvbC10b3dlci5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9nZXQtaWRjLWluZm8uanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvZ2V0LW9yZy1kZXRhaWxzLmpzIiwid2VicGFjazovLy8uL2J1aWxkL3NyYy9hY3Rpb25zL2dldC1vcmctb3VzLmpzIiwid2VicGFjazovLy8uL2J1aWxkL3NyYy9hY3Rpb25zL2dldC1vcmctbWVtYmVyLWFjY291bnRzLmpzIiwid2VicGFjazovLy8uL2J1aWxkL3NyYy9hY3Rpb25zL2NoZWNrLWlhbS11c2Vycy5qcyIsIndlYnBhY2s6Ly8vLi9idWlsZC9zcmMvYWN0aW9ucy9jaGVjay1lYzItZXhpc3RlbmNlLmpzIiwid2VicGFjazovLy8uL2J1aWxkL3NyYy9hY3Rpb25zL2NoZWNrLXZwYy1leGlzdGVuY2UuanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvY2hlY2stY2xvdWR0cmFpbC1leGlzdGVuY2UuanMiLCJ3ZWJwYWNrOi8vLy4vYnVpbGQvc3JjL2FjdGlvbnMvY2hlY2stY29uZmlnLWV4aXN0ZW5jZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIkBhd3Mtc2RrL2NsaWVudC1vcmdhbml6YXRpb25zXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiQGF3cy1zZGsvY2xpZW50LWlhbVwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIkBhd3Mtc2RrL2NsaWVudC1jbG91ZGZvcm1hdGlvblwiKTsiLCJjb25zdCBfX1dFQlBBQ0tfTkFNRVNQQUNFX09CSkVDVF9fID0gcmVxdWlyZShcIkBhd3Mtc2RrL2NsaWVudC1zc28tYWRtaW5cIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJAYXdzLXNkay9jbGllbnQtZWMyXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiQGF3cy1zZGsvY2xpZW50LWNsb3VkdHJhaWxcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJAYXdzLXNkay9jbGllbnQtY29uZmlnLXNlcnZpY2VcIik7IiwiY29uc3QgX19XRUJQQUNLX05BTUVTUEFDRV9PQkpFQ1RfXyA9IHJlcXVpcmUoXCJAYXdzLXNkay9jbGllbnQtY29udHJvbHRvd2VyXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiQGF3cy1zZGsvY2xpZW50LWNvc3QtYW5kLXVzYWdlLXJlcG9ydC1zZXJ2aWNlXCIpOyIsImNvbnN0IF9fV0VCUEFDS19OQU1FU1BBQ0VfT0JKRUNUX18gPSByZXF1aXJlKFwiZnNcIik7IiwiaW1wb3J0IHsgZGVmaW5lQWNjb3VudFR5cGUgfSBmcm9tICcuL3NyYy9hY3Rpb25zL2RlZmluZS1hY2NvdW50LXR5cGUuanMnO1xuaW1wb3J0IGNoZWNrSWFtVXNlcnMgZnJvbSAnLi9zcmMvYWN0aW9ucy9jaGVjay1pYW0tdXNlcnMuanMnO1xuaW1wb3J0IGdldEVuYWJsZWRPcmdQb2xpY3lUeXBlcyBmcm9tICcuL3NyYy9hY3Rpb25zL2dldC1lbmFibGVkLW9yZy1wb2xpY3ktdHlwZXMuanMnO1xuaW1wb3J0IGdldEVuYWJsZWRPcmdTZXJ2aWNlcyBmcm9tICcuL3NyYy9hY3Rpb25zL2dldC1lbmFibGVkLW9yZy1zZXJ2aWNlcy5qcyc7XG5pbXBvcnQgZ2V0T3JnQ2xvdWRGb3JtYXRpb24gZnJvbSAnLi9zcmMvYWN0aW9ucy9jaGVjay1vcmctY2xvdWRmb3JtYXRpb24uanMnO1xuaW1wb3J0IGdldElkY0luZm8gZnJvbSAnLi9zcmMvYWN0aW9ucy9nZXQtaWRjLWluZm8uanMnO1xuaW1wb3J0IGdldE9yZ0RldGFpbHMgZnJvbSAnLi9zcmMvYWN0aW9ucy9nZXQtb3JnLWRldGFpbHMuanMnO1xuaW1wb3J0IGdldE9yZ1RvcExldmVsT3VzIGZyb20gJy4vc3JjL2FjdGlvbnMvZ2V0LW9yZy1vdXMuanMnO1xuaW1wb3J0IGdldEFsbFJlZ2lvbnMgZnJvbSAnLi9zcmMvYWN0aW9ucy9nZXQtcmVnaW9ucy5qcyc7XG5pbXBvcnQgY2hlY2tFYzJFeGlzdHMgZnJvbSAnLi9zcmMvYWN0aW9ucy9jaGVjay1lYzItZXhpc3RlbmNlLmpzJztcbmltcG9ydCBjaGVja1ZwY0V4aXN0cyBmcm9tICcuL3NyYy9hY3Rpb25zL2NoZWNrLXZwYy1leGlzdGVuY2UuanMnO1xuaW1wb3J0IGNoZWNrQ2xvdWRUcmFpbEV4aXN0cyBmcm9tICcuL3NyYy9hY3Rpb25zL2NoZWNrLWNsb3VkdHJhaWwtZXhpc3RlbmNlLmpzJztcbmltcG9ydCBnZXRPcmdEYUFjY291bnRzIGZyb20gJy4vc3JjL2FjdGlvbnMvZ2V0LW9yZy1kYS1hY2NvdW50cy5qcyc7XG5pbXBvcnQgY2hlY2tDb25maWdFeGlzdHMgZnJvbSAnLi9zcmMvYWN0aW9ucy9jaGVjay1jb25maWctZXhpc3RlbmNlLmpzJztcbmltcG9ydCBnZXRPcmdNZW1iZXJBY2NvdW50cyBmcm9tICcuL3NyYy9hY3Rpb25zL2dldC1vcmctbWVtYmVyLWFjY291bnRzLmpzJztcbmltcG9ydCBnZXRDb250cm9sVG93ZXIgZnJvbSAnLi9zcmMvYWN0aW9ucy9jaGVjay1jb250cm9sLXRvd2VyLmpzJztcbmltcG9ydCBjaGVja0xlZ2FjeUN1ciBmcm9tICcuL3NyYy9hY3Rpb25zL2NoZWNrLWxlZ2FjeS1jdXIuanMnO1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnO1xuY29uc3QgbWFpbiA9IGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXBvcnRGaWxlID0gXCIuL1BhdGhmaW5kZXIudHh0XCI7XG4gICAgbGV0IGRhdGVUaW1lID0gbmV3IERhdGUoKTtcbiAgICBmcy53cml0ZUZpbGVTeW5jKHJlcG9ydEZpbGUsIFwiQ2xvdWQgRm91bmRhdGlvbnMgLSBQYXRoZmluZGVyXCIpO1xuICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5HZW5lcmF0ZWQgb246ICR7ZGF0ZVRpbWUudG9VVENTdHJpbmcoKX0gXFxuXFxuYCk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgIC8vIGdyYWIgcmVnaW9uIGZyb20gYXdzIENsb3VkU2hlbGwuIFNldCBkZWZhdWx0IHRob3VnaCByZWdpb24gc3BlY2lmaWMgY2FsbHMgYXJlIGZvciBnbG9iYWwgc2VydmljZXNcbiAgICAvLyBhbmQgdXMtZWFzdC0xIHdvcmtzIHRvIGdldCBkZXRhaWxzLlxuICAgIGNvbnN0IHJlZ2lvbiA9IHByb2Nlc3MuZW52LkFXU19SRUdJT04gfHwgJ3VzLWVhc3QtMSc7XG4gICAgLy8gZnVuY3Rpb24gY2hlY2tpbmcgaWYgbWFuYWdlbWVudCBhY2NvdW50LCBtZW1iZXIgYWNjb3VudCwgb3Igc3RhbmRhbG9uZSBhY2NvdW50XG4gICAgY29uc3QgYWxsUmVnaW9ucyA9IGF3YWl0IGdldEFsbFJlZ2lvbnMoKTtcbiAgICBjb25zdCBhY2NvdW50VHlwZSA9IGF3YWl0IGRlZmluZUFjY291bnRUeXBlKHJlZ2lvbik7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBBQ0NPVU5UIFRZUEVcXG5gKTtcbiAgICBpZiAoYWNjb3VudFR5cGUpIHtcbiAgICAgICAgY29uc29sZS5kaXIoYWNjb3VudFR5cGUsIHsgZGVwdGg6IG51bGwsIGNvbG9yczogdHJ1ZSB9KTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgSXMgaW4gQVdTIE9yZ2FuaXphdGlvbjogJHthY2NvdW50VHlwZS5pc0luT3JnYW5pemF0aW9ufWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBBc3Nlc3NpbmcgQVdTIE1hbmFnZW1lbnQgQWNjb3VudDogJHthY2NvdW50VHlwZS5pc01hbmFnZW1lbnRBY2NvdW50fWApO1xuICAgIH1cbiAgICAvLyBhbGwgY2FsbHMgcmVxdWlyZSBhbiBBV1MgT3JnYW5pemF0aW9uIGV4aXN0IGFuZCB0aGUgYWNjb3VudCBiZSBhIG1hbmFnZW1lbnQgYWNjb3VudFxuICAgIGlmIChhY2NvdW50VHlwZS5pc0luT3JnYW5pemF0aW9uICYmIGFjY291bnRUeXBlLmlzTWFuYWdlbWVudEFjY291bnQpIHtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuTGVnYWN5IENVUlxcbmApO1xuICAgICAgICBjb25zdCBsZWdhY3lDdXJDaGVjayA9IGF3YWl0IGNoZWNrTGVnYWN5Q3VyKHJlZ2lvbik7XG4gICAgICAgIGNvbnNvbGUuZGlyKGxlZ2FjeUN1ckNoZWNrLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIElzIGxlZ2FjeSBDVVIgc2V0dXA6ICR7bGVnYWN5Q3VyQ2hlY2suaXNMZWdhY3lDdXJTZXR1cH1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuQVdTIE9SR0FOSVpBVElPTiBQT0xJQ1kgVFlQRVNcXG5gKTtcbiAgICAgICAgY29uc3QgZW5hYmxlT3JnUG9saWNpZXNDaGVjayA9IGF3YWl0IGdldEVuYWJsZWRPcmdQb2xpY3lUeXBlcyhyZWdpb24pO1xuICAgICAgICBjb25zb2xlLmRpcihlbmFibGVPcmdQb2xpY2llc0NoZWNrLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIFNlcnZpY2UgQ29udHJvbCBQb2xpY2llcyAoU0NQKSBlbmFibGVkOiAke2VuYWJsZU9yZ1BvbGljaWVzQ2hlY2suc2NwRW5hYmxlZH1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgVGFnIFBvbGljaWVzIGVuYWJsZWQ6ICR7ZW5hYmxlT3JnUG9saWNpZXNDaGVjay50YWdQb2xpY3lFbmFibGVkfWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBCYWNrdXAgUG9saWNpZXMgZW5hYmxlZDogJHtlbmFibGVPcmdQb2xpY2llc0NoZWNrLmJhY2t1cFBvbGljeUVuYWJsZWR9YCk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBPUkdBTklaQVRJT04gRU5BQkxFRCBTRVJWSUNFU1xcbmApO1xuICAgICAgICBjb25zdCBvcmdFbmFibGVkU2VydmljZXMgPSBhd2FpdCBnZXRFbmFibGVkT3JnU2VydmljZXMocmVnaW9uKTtcbiAgICAgICAgY29uc29sZS5kaXIob3JnRW5hYmxlZFNlcnZpY2VzLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIFRoZSBmb2xsb3dpbmcgQVdTIFNlcnZpY2VzIGFyZSBlbmFibGVkIHdpdGhpbiB5b3VyIEFXUyBPcmdhbml6YXRpb246YCk7XG4gICAgICAgIGZvciAoY29uc3Qgb3JnU2VydmljZSBvZiBvcmdFbmFibGVkU2VydmljZXMpIHtcbiAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gICAgJHtvcmdTZXJ2aWNlLnNlcnZpY2V9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuQVdTIE9SR0FOSVpBVElPTiBJTlRFR1JBVEVEIFNFUlZJQ0UgUkVHSVNURVJFRCBERUxFR0FURUQgQURNSU5TXFxuYCk7XG4gICAgICAgIGNvbnN0IG9yZ0RlbEFkbWluRGV0YWlscyA9IGF3YWl0IGdldE9yZ0RhQWNjb3VudHMoKTtcbiAgICAgICAgY29uc29sZS5kaXIob3JnRGVsQWRtaW5EZXRhaWxzLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGlmIChvcmdEZWxBZG1pbkRldGFpbHMgJiYgb3JnRGVsQWRtaW5EZXRhaWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYWNjb3VudCBvZiBvcmdEZWxBZG1pbkRldGFpbHMpIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBBY2NvdW50OiAke2FjY291bnQuYWNjb3VudE5hbWV9YCk7XG4gICAgICAgICAgICAgICAgaWYgKGFjY291bnQuc2VydmljZXMgJiYgYWNjb3VudC5zZXJ2aWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIERlbGVnYXRlZCBTZXJ2aWNlczpgKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzcnYgb2YgYWNjb3VudC5zZXJ2aWNlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgICAke3Nydi5TZXJ2aWNlUHJpbmNpcGFsfWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBObyBkZWxlZ2F0ZWQgYWRtaW4gYWNjb3VudHMgaW4gQVdTIE9yZ2FuaXphdGlvbmApO1xuICAgICAgICB9XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBPUkdBTklaQVRJT04gQ0xPVURGT1JNQVRJT05cXG5gKTtcbiAgICAgICAgY29uc3QgY2ZuT3JnU3RhdHVzID0gYXdhaXQgZ2V0T3JnQ2xvdWRGb3JtYXRpb24ocmVnaW9uKTtcbiAgICAgICAgY29uc29sZS5kaXIoY2ZuT3JnU3RhdHVzLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIEFXUyBDbG91ZEZvcm1hdGlvbiBPcmdhbml6YXRpb24gc3RhY2sgc2V0cyBzdGF0dXMgOiAke2Nmbk9yZ1N0YXR1cy5zdGF0dXN9YCk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBDT05UUk9MIFRPV0VSXFxuYCk7XG4gICAgICAgIGNvbnN0IGNvbnRyb2xUb3dlckRldGFpbHMgPSBhd2FpdCBnZXRDb250cm9sVG93ZXIocmVnaW9uKTtcbiAgICAgICAgaWYgKGNvbnRyb2xUb3dlckRldGFpbHMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZGlyKGNvbnRyb2xUb3dlckRldGFpbHMsIHsgZGVwdGg6IG51bGwsIGNvbG9yczogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIENvbnRyb2wgVG93ZXIgaG9tZSByZWdpb246ICR7Y29udHJvbFRvd2VyRGV0YWlscy5jb250cm9sVG93ZXJSZWdpb259YCk7XG4gICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBDb250cm9sIFRvd2VyIHN0YXR1czogJHtjb250cm9sVG93ZXJEZXRhaWxzLnN0YXR1c31gKTtcbiAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIENvbnRyb2wgVG93ZXIgTGFuZGluZyBab25lIHZlcnNpb246ICR7Y29udHJvbFRvd2VyRGV0YWlscy5kZXBsb3llZFZlcnNpb259YCk7XG4gICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBMYXRlc3QgYXZhaWxhYmxlIHZlcnNpb246ICR7Y29udHJvbFRvd2VyRGV0YWlscy5kZXBsb3llZFZlcnNpb259YCk7XG4gICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBEcmlmdCBTdGF0dXM6ICR7Y29udHJvbFRvd2VyRGV0YWlscy5kcmlmdFN0YXR1c31gKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIEFXUyBDb250cm9sIFRvd2VyIGlzIG5vdCBkZXBsb3llZCBpbiB0aGUgQVdTIE9yZ2FuaXphdGlvbmApO1xuICAgICAgICB9XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBJQU0gSURFTlRJVFkgQ0VOVEVSXFxuYCk7XG4gICAgICAgIGNvbnN0IGlkY0luZm9ybWF0aW9uID0gYXdhaXQgZ2V0SWRjSW5mbyhhbGxSZWdpb25zKTtcbiAgICAgICAgY29uc29sZS5kaXIoaWRjSW5mb3JtYXRpb24sIHsgZGVwdGg6IG51bGwsIGNvbG9yczogdHJ1ZSB9KTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgSWRDIFJlZ2lvbjogJHtpZGNJbmZvcm1hdGlvbi5yZWdpb259YCk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIElkQyBBUk46ICR7aWRjSW5mb3JtYXRpb24uYXJufWApO1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBJZEMgSW5zdGFuY2UgSWQ6ICR7aWRjSW5mb3JtYXRpb24uaWR9YCk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBPUkdBTklaQVRJT04gREVUQUlMU1xcbmApO1xuICAgICAgICBjb25zdCBvcmdEZXRhaWxzID0gYXdhaXQgZ2V0T3JnRGV0YWlscyhyZWdpb24pO1xuICAgICAgICBjb25zb2xlLmRpcihvcmdEZXRhaWxzLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIEFXUyBPcmdhbml6YXRpb24gSWQ6ICR7b3JnRGV0YWlscy5pZH1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgQVdTIE9yZ2FuaXphdGlvbiBBUk46ICR7b3JnRGV0YWlscy5hcm59YCk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIEFXUyBPcmdhbml6YXRpb24gUm9vdCBPVSBJZDogJHtvcmdEZXRhaWxzLnJvb3RPdUlkfWApO1xuICAgICAgICBpZiAob3JnRGV0YWlscy5yb290T3VJZCkge1xuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBPUkdBTklaQVRJT04gVE9QLUxFVkVMIE9SR0FOSVpBVElPTiBVTklUU1xcbmApO1xuICAgICAgICAgICAgY29uc3Qgb3JnT3VzID0gYXdhaXQgZ2V0T3JnVG9wTGV2ZWxPdXMocmVnaW9uLCBvcmdEZXRhaWxzLnJvb3RPdUlkKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZGlyKG9yZ091cywgeyBkZXB0aDogbnVsbCwgY29sb3JzOiB0cnVlIH0pO1xuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgTGlzdCBvZiBPcmdhbml6YXRpb24ncyB0b3AtbGV2ZWwgT1VzIGFuZCBBV1MgYWNjb3VudHM6YCk7XG4gICAgICAgICAgICBpZiAob3JnT3VzICYmIG9yZ091cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBvdSBvZiBvcmdPdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgICBPcmdhbml6YXRpb25hbCBVbml0OiAke291Lm5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gICAgICBPcmdhbml6YXRpb25hbCBVbml0IElkOiAke291LmlkfWApO1xuICAgICAgICAgICAgICAgICAgICBpZiAob3UuYWNjb3VudHMgJiYgb3UuYWNjb3VudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgICAgIEFXUyBBY2NvdW50czpgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYWNjb3VudCBvZiBvdS5hY2NvdW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gICAgICAgICR7YWNjb3VudC5OYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbmApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgICAgIEFXUyBBY2NvdW50czogTm9uZWApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBObyB0b3AgbGV2ZWwgT1VzIGZvdW5kLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBPUkdBTklaQVRJT04gTUVNQkVSIEFDQ09VTlRTXFxuYCk7XG4gICAgICAgIGNvbnN0IG9yZ01lbWJlckFjY291bnREZXRhaWxzID0gYXdhaXQgZ2V0T3JnTWVtYmVyQWNjb3VudHMoKTtcbiAgICAgICAgY29uc29sZS5kaXIob3JnTWVtYmVyQWNjb3VudERldGFpbHMsIHsgZGVwdGg6IG51bGwsIGNvbG9yczogdHJ1ZSB9KTtcbiAgICAgICAgaWYgKG9yZ01lbWJlckFjY291bnREZXRhaWxzICYmIG9yZ01lbWJlckFjY291bnREZXRhaWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbWVtYmVyQWNjb3VudCBvZiBvcmdNZW1iZXJBY2NvdW50RGV0YWlscykge1xuICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIEFjY291bnQ6ICR7bWVtYmVyQWNjb3VudC5hY2NvdW50TmFtZX1gKTtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBBY2NvdW50IEVtYWlsOiAke21lbWJlckFjY291bnQuYWNjb3VudEVtYWlsfVxcbmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYE5vIG1lbWJlciBhY2NvdW50cyBmb3VuZCB3aGljaCBpcyBhbWF6aW5nIGFzIHRoaXMgaXMgcnVubmluZyBmcm9tIG9uZS5gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhY2NvdW50VHlwZS5pc0luT3JnYW5pemF0aW9uICYmICFhY2NvdW50VHlwZS5pc01hbmFnZW1lbnRBY2NvdW50KSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSAnXFxuV0FSTklORzogWW91IGFyZSBydW5uaW5nIFBBQVQgZnJvbSBhbiBhY2NvdW50IHRoYXQgaXMgYSBtZW1iZXIgb2YgeW91ciBBV1MgT3JnYW5pemF0aW9uLiBQbGVhc2UgcnVuIHRoZSBzb2x1dGlvbiBmcm9tIHlvdXIgQVdTIE1hbmFnZW1lbnQgYWNjb3VudC4nO1xuICAgICAgICBjb25zb2xlLndhcm4obWVzc2FnZSk7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIG1lc3NhZ2UpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9ICdcXG5XQVJOSU5HOiBZb3UgYXJlIHJ1bm5pbmcgUEFBVCBmcm9tIGFuIGFjY291bnQgdGhhdCBub3QgcGFydCBvZiBhbiBBV1MgT3JnYW5pemF0aW9uLiBUaGlzIGFjY291bnQgd2lsbCBiZSB0cmVhdGVkIGFzIGEgc3RhbmRhbG9uZSBhY2NvdW50Lic7XG4gICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgbWVzc2FnZSk7XG4gICAgfVxuICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tYCk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbkFXUyBNQU5BR0VNRU5UIEFDQ09VTlQgQ0hFQ0tTYCk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cXG5gKTtcbiAgICAvLyBHZW5lcmFsIGFjY291bnQgY2hlY2tzIGZvciBhbGwgYWNjb3VudCB0eXBlcyAobWFuYWdlbWVudCBhY2NvdW50LCBtZW1iZXIgYWNjb3VudCwgc3RhbmRhbG9uZSlcbiAgICAvLyAxLiBsaXN0IGFsbCBJQU0gdXNlcnMgYW5kIGlmIHRoZXkgaGF2ZSBrZXlzIGluIHRoZSBhd3MgYWNjb3VudFxuICAgIGNvbnN0IGlhbVVzZXJSZXN1bHQgPSBhd2FpdCBjaGVja0lhbVVzZXJzKCk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbklBTSBVU0VSUyBDSEVDS1xcbmApO1xuICAgIGlmIChpYW1Vc2VyUmVzdWx0ICYmIGlhbVVzZXJSZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zb2xlLmRpcihpYW1Vc2VyUmVzdWx0LCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZvciAoY29uc3QgaWFtVXNlciBvZiBpYW1Vc2VyUmVzdWx0KSB7XG4gICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBJQU0gVXNlcjogJHtpYW1Vc2VyLnVzZXJOYW1lfWApO1xuICAgICAgICAgICAgaWYgKGlhbVVzZXIuYWNjZXNzS2V5SWQpIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICAgIFVzZXIgQVBJIEtleSBJRDogJHtpYW1Vc2VyLmFjY2Vzc0tleUlkfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbmApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBObyBJQU0gVXNlcnMgZm91bmQuYCk7XG4gICAgfVxuICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5cXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1gKTtcbiAgICAvLyAyLiBmaW5kIG91dCBpZiBFQzIgd29ya2xvYWRzIGFyZSBydW5uaW5nIGluIHRoZSBhY2NvdW50XG4gICAgY29uc3QgZWMyQ2hlY2sgPSBhd2FpdCBjaGVja0VjMkV4aXN0cyhhbGxSZWdpb25zKTtcbiAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuRUMyIElOU1RBTkNFIENIRUNLXFxuYCk7XG4gICAgaWYgKGVjMkNoZWNrICYmIGVjMkNoZWNrLmZpbmQocGFyYW0gPT4gcGFyYW0uZWMyRm91bmQgPT09IHRydWUpKSB7XG4gICAgICAgIGNvbnNvbGUuZGlyKGVjMkNoZWNrLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZvciAoY29uc3QgZWMyIG9mIGVjMkNoZWNrKSB7XG4gICAgICAgICAgICBpZiAoZWMyLmVjMkZvdW5kKSB7XG4gICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgJHtlYzIucmVnaW9ufSAtIGZvdW5kIEVDMiBJbnN0YW5jZShzKS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgTm8gRUMyIGluc3RhbmNlcyBmb3VuZC5gKTtcbiAgICB9XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgIC8vIDMuIGxpc3QgYWxsIFZQQ3MgKGRlZmF1bHQgb3Igbm90KVxuICAgIGNvbnN0IHZwY0NoZWNrID0gYXdhaXQgY2hlY2tWcGNFeGlzdHMoYWxsUmVnaW9ucyk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcblZQQyBDSEVDS1xcbmApO1xuICAgIGlmICh2cGNDaGVjayAmJiB2cGNDaGVjay5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUuZGlyKHZwY0NoZWNrLCB7IGRlcHRoOiBudWxsLCBjb2xvcnM6IHRydWUgfSk7XG4gICAgICAgIGZvciAoY29uc3QgdnBjRmluZCBvZiB2cGNDaGVjaykge1xuICAgICAgICAgICAgaWYgKHZwY0ZpbmQudnBjRm91bmQpIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICAke3ZwY0ZpbmQucmVnaW9ufSAtIGZvdW5kIFZQQyhzKS5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbiAgTm8gVlBDcyBmb3VuZC5gKTtcbiAgICB9XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLWApO1xuICAgIC8vIDQuIGNoZWNrIGZvciBjbG91ZHRyYWlsIHJ1bm5pbmdcbiAgICBjb25zdCBjbG91ZFRyYWlsQ2hlY2sgPSBhd2FpdCBjaGVja0Nsb3VkVHJhaWxFeGlzdHMoYWxsUmVnaW9ucyk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkNMT1VEVFJBSUwgQ0hFQ0tcXG5gKTtcbiAgICBpZiAoY2xvdWRUcmFpbENoZWNrICYmIGNsb3VkVHJhaWxDaGVjay5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnNvbGUuZGlyKGNsb3VkVHJhaWxDaGVjaywgeyBkZXB0aDogbnVsbCwgY29sb3JzOiB0cnVlIH0pO1xuICAgICAgICBmb3IgKGNvbnN0IGN0RmluZCBvZiBjbG91ZFRyYWlsQ2hlY2spIHtcbiAgICAgICAgICAgIGlmIChjdEZpbmQudHJhaWxGb3VuZCkge1xuICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIENsb3VkVHJhaWwgZm91bmQgaW4gJHtjdEZpbmQucmVnaW9ufWApO1xuICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gICAgSXMgT3JnYW5pemF0aW9uIFRyYWlsOiAke2N0RmluZC5pc09yZ1RyYWlsfWApO1xuICAgICAgICAgICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gICAgSXMgTXVsdGlSZWdpb246ICR7Y3RGaW5kLmlzTXVsdGlSZWdpb259YCk7XG4gICAgICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcbmApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICBObyBBV1MgQ2xvdWRUcmFpbCByZXNvdXJjZSBkaXNjb3ZlcmVkYCk7XG4gICAgfVxuICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG5gKTtcbiAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tYCk7XG4gICAgLy8gNS4gY2hlY2sgZm9yIEFXUyBjb25maWcgcmVjb3JkZXJzIGFuZCBkZWxpdmVyeSBjaGFubmVsc1xuICAgIGNvbnN0IGNvbmZpZ0NoZWNrID0gYXdhaXQgY2hlY2tDb25maWdFeGlzdHMoYWxsUmVnaW9ucyk7XG4gICAgZnMuYXBwZW5kRmlsZVN5bmMocmVwb3J0RmlsZSwgYFxcblxcbkFXUyBDT05GSUcgQ0hFQ0tcXG5gKTtcbiAgICBpZiAoY29uZmlnQ2hlY2sgJiYgY29uZmlnQ2hlY2suZmluZChwYXJhbSA9PiBwYXJhbS5jb25maWdSZWNvcmRlckZvdW5kID09PSB0cnVlKSkge1xuICAgICAgICBjb25zb2xlLmRpcihjb25maWdDaGVjaywgeyBkZXB0aDogbnVsbCwgY29sb3JzOiB0cnVlIH0pO1xuICAgICAgICBmb3IgKGNvbnN0IGNvbmZpZ0ZpbmQgb2YgY29uZmlnQ2hlY2spIHtcbiAgICAgICAgICAgIGlmIChjb25maWdGaW5kLmNvbmZpZ1JlY29yZGVyRm91bmQpIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICAke2NvbmZpZ0ZpbmQucmVnaW9ufSAtIENvbmZpZyBSZWNvcmRlciBmb3VuZGApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvbmZpZ0ZpbmQuY29uZmlnRGVsaXZlcnlDaGFubmVsRm91bmQpIHtcbiAgICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuICAke2NvbmZpZ0ZpbmQucmVnaW9ufSAtIENvbmZpZyBEZWxpdmVyeSBDaGFubmVsIGZvdW5kYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGZzLmFwcGVuZEZpbGVTeW5jKHJlcG9ydEZpbGUsIGBcXG4gIE5vIEFXUyBDb25maWcgcmVzb3VyY2UgZGlzY292ZXJlZGApO1xuICAgIH1cbiAgICBmcy5hcHBlbmRGaWxlU3luYyhyZXBvcnRGaWxlLCBgXFxuXFxuXFxuICBFTkQgQVNTRVNTTUVOVGApO1xufTtcbm1haW4oKTtcbiIsImltcG9ydCB7IEVDMkNsaWVudCwgRGVzY3JpYmVSZWdpb25zQ29tbWFuZCB9IGZyb20gXCJAYXdzLXNkay9jbGllbnQtZWMyXCI7XG5hc3luYyBmdW5jdGlvbiBnZXRBbGxSZWdpb25zKCkge1xuICAgIC8vIGdyYWJiaW5nIGFsbCByZWdpb25zIGZyb20gdXMtZWFzdC0xXG4gICAgY29uc3QgZWMyQ2xpZW50ID0gbmV3IEVDMkNsaWVudCh7IHJlZ2lvbjogXCJ1cy1lYXN0LTFcIiB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBkZXNjcmliZVJlZ2lvbnNDb21tYW5kID0gbmV3IERlc2NyaWJlUmVnaW9uc0NvbW1hbmQoe30pO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVjMkNsaWVudC5zZW5kKGRlc2NyaWJlUmVnaW9uc0NvbW1hbmQpO1xuICAgICAgICBjb25zdCByZWdpb25zID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcmVnaW9uIG9mIHJlc3BvbnNlLlJlZ2lvbnMgfHwgW10pIHtcbiAgICAgICAgICAgIHJlZ2lvbnMucHVzaChyZWdpb24uUmVnaW9uTmFtZSB8fCBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVnaW9ucztcbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZXRyaWV2aW5nIHJlZ2lvbnM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBmaW5hbGx5IHtcbiAgICAgICAgZWMyQ2xpZW50LmRlc3Ryb3koKTtcbiAgICB9XG59XG5leHBvcnQgZGVmYXVsdCBnZXRBbGxSZWdpb25zO1xuIiwiaW1wb3J0IHsgT3JnYW5pemF0aW9uc0NsaWVudCwgRGVzY3JpYmVPcmdhbml6YXRpb25Db21tYW5kLCB9IGZyb20gXCJAYXdzLXNkay9jbGllbnQtb3JnYW5pemF0aW9uc1wiO1xuLy8gZnVuY3Rpb24gY2hlY2tpbmcgaWYgbWFuYWdlbWVudCBhY2NvdW50LCBtZW1iZXIgYWNjb3VudCwgb3Igc3RhbmRhbG9uZSBhY2NvdW50XG5leHBvcnQgY29uc3QgZGVmaW5lQWNjb3VudFR5cGUgPSBhc3luYyAocmVnaW9uKSA9PiB7XG4gICAgY29uc3Qgb3JnYW5pemF0aW9uc0NsaWVudCA9IG5ldyBPcmdhbml6YXRpb25zQ2xpZW50KHsgcmVnaW9uIH0pO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRlc2NyaWJlT3JnYW5pemF0aW9uQ29tbWFuZCA9IG5ldyBEZXNjcmliZU9yZ2FuaXphdGlvbkNvbW1hbmQoe30pO1xuICAgICAgICBjb25zdCBkZXNjcmliZU9yZ2FuaXphdGlvblJlc3BvbnNlID0gYXdhaXQgb3JnYW5pemF0aW9uc0NsaWVudC5zZW5kKGRlc2NyaWJlT3JnYW5pemF0aW9uQ29tbWFuZCk7XG4gICAgICAgIGNvbnN0IGlzSW5Pcmdhbml6YXRpb24gPSAhIWRlc2NyaWJlT3JnYW5pemF0aW9uUmVzcG9uc2UuT3JnYW5pemF0aW9uO1xuICAgICAgICAvLyB0aGUgYWNjb3VudCBpcyBub3Qgc3RhbmRhbG9uZSBhbmQgcGFydCBvZiBBV1MgT3JnYW5pemF0aW9uXG4gICAgICAgIGlmIChkZXNjcmliZU9yZ2FuaXphdGlvblJlc3BvbnNlLk9yZ2FuaXphdGlvbj8uTWFzdGVyQWNjb3VudElkKSB7XG4gICAgICAgICAgICBjb25zdCBpc01hbmFnZW1lbnRBY2NvdW50ID0gZGVzY3JpYmVPcmdhbml6YXRpb25SZXNwb25zZS5Pcmdhbml6YXRpb24/Lk1hc3RlckFjY291bnRJZCA9PT0gZGVzY3JpYmVPcmdhbml6YXRpb25SZXNwb25zZS5Pcmdhbml6YXRpb24/Lk1hc3RlckFjY291bnRJZDtcbiAgICAgICAgICAgIHJldHVybiB7IGlzSW5Pcmdhbml6YXRpb24sIGlzTWFuYWdlbWVudEFjY291bnQgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7IGlzSW5Pcmdhbml6YXRpb24gfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IGlzSW5Pcmdhbml6YXRpb246IGZhbHNlIH07XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBvcmdhbml6YXRpb25zQ2xpZW50LmRlc3Ryb3koKTtcbiAgICB9XG59O1xuIiwiaW1wb3J0IHsgQ29zdEFuZFVzYWdlUmVwb3J0U2VydmljZUNsaWVudCwgRGVzY3JpYmVSZXBvcnREZWZpbml0aW9uc0NvbW1hbmQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LWNvc3QtYW5kLXVzYWdlLXJlcG9ydC1zZXJ2aWNlXCI7XG5jb25zdCBjaGVja0xlZ2FjeUN1ciA9IGFzeW5jIChyZWdpb24pID0+IHtcbiAgICAvLyBTZXQgdXAgQVdTIFNESyBjbGllbnQgZm9yIENvc3QgRXhwbG9yZXJcbiAgICBjb25zdCBjdXJDbGllbnQgPSBuZXcgQ29zdEFuZFVzYWdlUmVwb3J0U2VydmljZUNsaWVudCh7IHJlZ2lvbiB9KTtcbiAgICBsZXQgaXNMZWdhY3lDdXJTZXR1cCA9IGZhbHNlO1xuICAgIHRyeSB7XG4gICAgICAgIC8vIENoZWNrIGlmIENvc3QgRXhwbG9yZXIgaXMgc2V0IHVwXG4gICAgICAgIGNvbnN0IGlucHV0ID0ge307XG4gICAgICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgRGVzY3JpYmVSZXBvcnREZWZpbml0aW9uc0NvbW1hbmQoaW5wdXQpO1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGN1ckNsaWVudC5zZW5kKGNvbW1hbmQpO1xuICAgICAgICBpZiAocmVzcG9uc2UuUmVwb3J0RGVmaW5pdGlvbnMgJiYgcmVzcG9uc2UuUmVwb3J0RGVmaW5pdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgaXNMZWdhY3lDdXJTZXR1cCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgaXNMZWdhY3lDdXJTZXR1cCB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGVycm9yIGlzIHJlbGF0ZWQgdG8gQ29zdCBFeHBsb3JlciBzZXR1cFxuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJvcn1gKTtcbiAgICAgICAgaXNMZWdhY3lDdXJTZXR1cCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4geyBpc0xlZ2FjeUN1clNldHVwIH07XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICAvLyBDbG9zZSB0aGUgQVdTIFNESyBjbGllbnRcbiAgICAgICAgY3VyQ2xpZW50LmRlc3Ryb3koKTtcbiAgICB9XG59O1xuZXhwb3J0IGRlZmF1bHQgY2hlY2tMZWdhY3lDdXI7XG4iLCJpbXBvcnQgeyBPcmdhbml6YXRpb25zQ2xpZW50LCBMaXN0Um9vdHNDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1vcmdhbml6YXRpb25zXCI7XG5hc3luYyBmdW5jdGlvbiBnZXRFbmFibGVkT3JnUG9saWN5VHlwZXMocmVnaW9uKSB7XG4gICAgY29uc3Qgb3JnQ2xpZW50ID0gbmV3IE9yZ2FuaXphdGlvbnNDbGllbnQoeyByZWdpb24gfSk7XG4gICAgbGV0IHBvbGljeVR5cGVzRW5hYmxlZCA9IHtcbiAgICAgICAgc2NwRW5hYmxlZDogZmFsc2UsXG4gICAgICAgIHRhZ1BvbGljeUVuYWJsZWQ6IGZhbHNlLFxuICAgICAgICBiYWNrdXBQb2xpY3lFbmFibGVkOiBmYWxzZVxuICAgIH07XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaW5wdXQgPSB7fTtcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IG5ldyBMaXN0Um9vdHNDb21tYW5kKGlucHV0KTtcbiAgICAgICAgY29uc3Qgcm9vdHMgPSBhd2FpdCBvcmdDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICAgICAgaWYgKHJvb3RzLlJvb3RzKSB7XG4gICAgICAgICAgICBpZiAocm9vdHMuUm9vdHNbMF0uUG9saWN5VHlwZXMpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGVuYWJsZWRQb2xpY3kgb2Ygcm9vdHMuUm9vdHNbMF0uUG9saWN5VHlwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuYWJsZWRQb2xpY3kuVHlwZSA9PSAnU0VSVklDRV9DT05UUk9MX1BPTElDWScgJiYgZW5hYmxlZFBvbGljeS5TdGF0dXMgPT0gJ0VOQUJMRUQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lUeXBlc0VuYWJsZWQuc2NwRW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuYWJsZWRQb2xpY3kuVHlwZSA9PSAnVEFHX1BPTElDWScgJiYgZW5hYmxlZFBvbGljeS5TdGF0dXMgPT0gJ0VOQUJMRUQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lUeXBlc0VuYWJsZWQudGFnUG9saWN5RW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuYWJsZWRQb2xpY3kuVHlwZSA9PSAnQkFDS1VQX1BPTElDWScgJiYgZW5hYmxlZFBvbGljeS5TdGF0dXMgPT0gJ0VOQUJMRUQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb2xpY3lUeXBlc0VuYWJsZWQuYmFja3VwUG9saWN5RW5hYmxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IC8vIGVuZCBmb3JcbiAgICAgICAgICAgIH0gLy8gZW5kIGlmXG4gICAgICAgIH0gLy8gZW5kIGlmXG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBBbiBlcnJvciBvY2N1cnJlZDogJHtlcnJvcn1gKTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIG9yZ0NsaWVudC5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiBwb2xpY3lUeXBlc0VuYWJsZWQ7XG4gICAgfVxufVxuZXhwb3J0IGRlZmF1bHQgZ2V0RW5hYmxlZE9yZ1BvbGljeVR5cGVzO1xuIiwiaW1wb3J0IHsgT3JnYW5pemF0aW9uc0NsaWVudCwgTGlzdEFXU1NlcnZpY2VBY2Nlc3NGb3JPcmdhbml6YXRpb25Db21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1vcmdhbml6YXRpb25zXCI7XG5hc3luYyBmdW5jdGlvbiBnZXRFbmFibGVkT3JnU2VydmljZXMocmVnaW9uKSB7XG4gICAgY29uc3QgZGlzY292ZXJlZE9yZ1NlcnZpY2VzID0gW107XG4gICAgY29uc3Qgb3JnQ2xpZW50ID0gbmV3IE9yZ2FuaXphdGlvbnNDbGllbnQoeyByZWdpb24gfSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgb3JnU2VydmljZUFjY2Vzc0NvbW1hbmQgPSBuZXcgTGlzdEFXU1NlcnZpY2VBY2Nlc3NGb3JPcmdhbml6YXRpb25Db21tYW5kKHt9KTtcbiAgICAgICAgY29uc3Qgb3JnU2VydmljZUFjY2Vzc1Jlc3BvbnNlID0gYXdhaXQgb3JnQ2xpZW50LnNlbmQob3JnU2VydmljZUFjY2Vzc0NvbW1hbmQpO1xuICAgICAgICBpZiAob3JnU2VydmljZUFjY2Vzc1Jlc3BvbnNlLkVuYWJsZWRTZXJ2aWNlUHJpbmNpcGFscyAmJiBvcmdTZXJ2aWNlQWNjZXNzUmVzcG9uc2UuRW5hYmxlZFNlcnZpY2VQcmluY2lwYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG9yZ1NlcnZpY2VBY2Nlc3NSZXNwb25zZS5FbmFibGVkU2VydmljZVByaW5jaXBhbHM7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG9yZ1NlcnZpY2Ugb2Ygb3JnU2VydmljZUFjY2Vzc1Jlc3BvbnNlLkVuYWJsZWRTZXJ2aWNlUHJpbmNpcGFscykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvdW5kT3JnU2VydmljZSA9IHsgc2VydmljZTogb3JnU2VydmljZS5TZXJ2aWNlUHJpbmNpcGFsID8/IFwiXCIgfTtcbiAgICAgICAgICAgICAgICBkaXNjb3ZlcmVkT3JnU2VydmljZXMucHVzaChmb3VuZE9yZ1NlcnZpY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBzZXJ2aWNlIGFjY2VzczonLCBlcnJvcik7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBvcmdDbGllbnQuZGVzdHJveSgpO1xuICAgICAgICByZXR1cm4gZGlzY292ZXJlZE9yZ1NlcnZpY2VzO1xuICAgIH1cbn1cbjtcbmV4cG9ydCBkZWZhdWx0IGdldEVuYWJsZWRPcmdTZXJ2aWNlcztcbiIsImltcG9ydCB7IE9yZ2FuaXphdGlvbnNDbGllbnQsIExpc3REZWxlZ2F0ZWRBZG1pbmlzdHJhdG9yc0NvbW1hbmQsIExpc3REZWxlZ2F0ZWRTZXJ2aWNlc0ZvckFjY291bnRDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1vcmdhbml6YXRpb25zXCI7XG5hc3luYyBmdW5jdGlvbiBnZXRPcmdEYUFjY291bnRzKCkge1xuICAgIGxldCBvcmdEYURldGFpbHMgPSBbXTtcbiAgICBjb25zdCBvcmdDbGllbnQgPSBuZXcgT3JnYW5pemF0aW9uc0NsaWVudCh7IHJlZ2lvbjogJ3VzLWVhc3QtMScgfSk7XG4gICAgbGV0IG9yZ0RhRGV0YWlsID0ge307XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29tbWFuZCA9IG5ldyBMaXN0RGVsZWdhdGVkQWRtaW5pc3RyYXRvcnNDb21tYW5kKHt9KTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcmdDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLkRlbGVnYXRlZEFkbWluaXN0cmF0b3JzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRhIG9mIHJlc3BvbnNlLkRlbGVnYXRlZEFkbWluaXN0cmF0b3JzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB7IEFjY291bnRJZDogZGEuSWQgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21tYW5kID0gbmV3IExpc3REZWxlZ2F0ZWRTZXJ2aWNlc0ZvckFjY291bnRDb21tYW5kKGlucHV0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBhY2NvdW50UmVzcG9uc2UgPSBhd2FpdCBvcmdDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoYWNjb3VudFJlc3BvbnNlLkRlbGVnYXRlZFNlcnZpY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIG9yZ0RhRGV0YWlsID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZXM6IGFjY291bnRSZXNwb25zZS5EZWxlZ2F0ZWRTZXJ2aWNlcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnROYW1lOiBkYS5OYW1lXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIG9yZ0RhRGV0YWlscy5wdXNoKG9yZ0RhRGV0YWlsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvciBsb29raW5nIGZvciBkZWxlZ2F0ZWQgc2VydmljZXMuYCk7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBvcmdDbGllbnQuZGVzdHJveSgpO1xuICAgIH1cbiAgICByZXR1cm4gb3JnRGFEZXRhaWxzO1xufVxuO1xuZXhwb3J0IGRlZmF1bHQgZ2V0T3JnRGFBY2NvdW50cztcbiIsImltcG9ydCB7IENsb3VkRm9ybWF0aW9uQ2xpZW50LCBEZXNjcmliZU9yZ2FuaXphdGlvbnNBY2Nlc3NDb21tYW5kLCB9IGZyb20gXCJAYXdzLXNkay9jbGllbnQtY2xvdWRmb3JtYXRpb25cIjtcbmFzeW5jIGZ1bmN0aW9uIGdldE9yZ0Nsb3VkRm9ybWF0aW9uKHJlZ2lvbikge1xuICAgIGxldCBvcmdDZm5TdGF0dXMgPSB7XG4gICAgICAgIHN0YXR1czogXCJkaXNhYmxlZFwiXG4gICAgfTtcbiAgICBjb25zdCBjbG91ZEZvcm1hdGlvbkNsaWVudCA9IG5ldyBDbG91ZEZvcm1hdGlvbkNsaWVudCh7IHJlZ2lvbiB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBkZXNjcmliZU9yZ0FjY2Vzc0lucHV0ID0ge307XG4gICAgICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgRGVzY3JpYmVPcmdhbml6YXRpb25zQWNjZXNzQ29tbWFuZChkZXNjcmliZU9yZ0FjY2Vzc0lucHV0KTtcbiAgICAgICAgY29uc3QgY2xvdWRGb3JtYXRpb25PcmdBY2Nlc3MgPSBhd2FpdCBjbG91ZEZvcm1hdGlvbkNsaWVudC5zZW5kKGNvbW1hbmQpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKFwiQ2xvdWRGb3JtYXRpb24gYWN0aXZhdGlvbiBzdGF0dXM6IFwiLCBjbG91ZEZvcm1hdGlvbk9yZ0FjY2Vzcy5TdGF0dXMpXG4gICAgICAgIG9yZ0NmblN0YXR1cy5zdGF0dXMgPSBjbG91ZEZvcm1hdGlvbk9yZ0FjY2Vzcy5TdGF0dXMgPz8gXCJkaXNhYmxlZFwiO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApO1xuICAgICAgICAvL3Rocm93IG5ldyBFcnJvcihgRXJyb3I6ICR7ZXJyb3J9YCk7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBjbG91ZEZvcm1hdGlvbkNsaWVudC5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiBvcmdDZm5TdGF0dXM7XG4gICAgfVxufVxuO1xuZXhwb3J0IGRlZmF1bHQgZ2V0T3JnQ2xvdWRGb3JtYXRpb247XG4iLCJpbXBvcnQgeyBDb250cm9sVG93ZXJDbGllbnQsIExpc3RMYW5kaW5nWm9uZXNDb21tYW5kLCBHZXRMYW5kaW5nWm9uZUNvbW1hbmQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LWNvbnRyb2x0b3dlclwiO1xuYXN5bmMgZnVuY3Rpb24gZ2V0Q29udHJvbFRvd2VyKHJlZ2lvbikge1xuICAgIGxldCBjb250cm9sVG93ZXJJbmZvID0ge307XG4gICAgY29uc3QgY29udHJvbFRvd2VyQ2xpZW50ID0gbmV3IENvbnRyb2xUb3dlckNsaWVudCh7IHJlZ2lvbiB9KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb21tYW5kID0gbmV3IExpc3RMYW5kaW5nWm9uZXNDb21tYW5kKHt9KTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjb250cm9sVG93ZXJDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UubGFuZGluZ1pvbmVzLCBudWxsLCAyKSk7XG4gICAgICAgIGlmIChyZXNwb25zZS5sYW5kaW5nWm9uZXMgJiYgcmVzcG9uc2UubGFuZGluZ1pvbmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICAgICAgICAgIGxhbmRpbmdab25lSWRlbnRpZmllcjogcmVzcG9uc2UubGFuZGluZ1pvbmVzWzBdLmFybixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb25zdCBselJlZ2lvbiA9IHJlc3BvbnNlLmxhbmRpbmdab25lc1swXS5hcm4/LnRvU3RyaW5nKCkuc3BsaXQoJzonKVszXSA/PyBcIlwiO1xuICAgICAgICAgICAgaWYgKGx6UmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbFRvd2VySW5mby5jb250cm9sVG93ZXJSZWdpb24gPSBselJlZ2lvbjtcbiAgICAgICAgICAgICAgICBjb25zdCBjb250cm9sVG93ZXJDbGllbnRSZWdpb24gPSBuZXcgQ29udHJvbFRvd2VyQ2xpZW50KHsgcmVnaW9uOiBselJlZ2lvbiB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldExhbmRpbmdab25lQ29tbWFuZChpbnB1dCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbHpSZXNwb25zZSA9IGF3YWl0IGNvbnRyb2xUb3dlckNsaWVudFJlZ2lvbi5zZW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgICAgIGlmIChselJlc3BvbnNlLmxhbmRpbmdab25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKEpTT04uc3RyaW5naWZ5KGx6UmVzcG9uc2UubGFuZGluZ1pvbmUsIG51bGwsIDIpKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbFRvd2VySW5mby5zdGF0dXMgPSBselJlc3BvbnNlLmxhbmRpbmdab25lLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbFRvd2VySW5mby5sYXRlc3RBdmFpbGFibGVWZXJzaW9uID0gbHpSZXNwb25zZS5sYW5kaW5nWm9uZS5sYXRlc3RBdmFpbGFibGVWZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sVG93ZXJJbmZvLmRlcGxveWVkVmVyc2lvbiA9IGx6UmVzcG9uc2UubGFuZGluZ1pvbmUudmVyc2lvbjtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbFRvd2VySW5mby5kcmlmdFN0YXR1cyA9IGx6UmVzcG9uc2UubGFuZGluZ1pvbmUuZHJpZnRTdGF0dXM/LnN0YXR1cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGNoZWNraW5nIENvbnRyb2wgVG93ZXIgaW4gJHtyZWdpb259OmAsIGVycm9yKTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIGNvbnRyb2xUb3dlckNsaWVudC5kZXN0cm95KCk7XG4gICAgfVxuICAgIHJldHVybiBjb250cm9sVG93ZXJJbmZvO1xufVxuZXhwb3J0IGRlZmF1bHQgZ2V0Q29udHJvbFRvd2VyO1xuIiwiaW1wb3J0IHsgU1NPQWRtaW5DbGllbnQsIExpc3RJbnN0YW5jZXNDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1zc28tYWRtaW5cIjtcbmFzeW5jIGZ1bmN0aW9uIGdldElkY0luZm8ocmVnaW9uTGlzdCkge1xuICAgIGxldCBpZGNEZXRhaWxzID0geyBmb3VuZDogZmFsc2UgfTtcbiAgICBmb3IgKGNvbnN0IHJlZ2lvbiBvZiByZWdpb25MaXN0KSB7XG4gICAgICAgIGNvbnN0IHNzb0FkbWluQ2xpZW50ID0gbmV3IFNTT0FkbWluQ2xpZW50KHsgcmVnaW9uIH0pO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3NvSW5wdXQgPSB7XG4gICAgICAgICAgICAgICAgTWF4UmVzdWx0czogTnVtYmVyKFwiMTAwXCIpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgY29uc3QgY29tbWFuZCA9IG5ldyBMaXN0SW5zdGFuY2VzQ29tbWFuZChzc29JbnB1dCk7XG4gICAgICAgICAgICBjb25zdCBzc29JbnN0YW5jZVJlc3BvbnNlID0gYXdhaXQgc3NvQWRtaW5DbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICAgICAgICAgIGlmIChzc29JbnN0YW5jZVJlc3BvbnNlLkluc3RhbmNlcyAmJiBzc29JbnN0YW5jZVJlc3BvbnNlLkluc3RhbmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3NvSW5zdGFuY2UgPSBzc29JbnN0YW5jZVJlc3BvbnNlLkluc3RhbmNlc1swXTtcbiAgICAgICAgICAgICAgICBpZGNEZXRhaWxzLmZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZGNEZXRhaWxzLnJlZ2lvbiA9IHJlZ2lvbjtcbiAgICAgICAgICAgICAgICBpZGNEZXRhaWxzLmFybiA9IHNzb0luc3RhbmNlLkluc3RhbmNlQXJuO1xuICAgICAgICAgICAgICAgIGlkY0RldGFpbHMuaWQgPSBzc29JbnN0YW5jZS5JZGVudGl0eVN0b3JlSWQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgbG9va2luZyBmb3IgQVdTIElkZW50aXR5IENlbnRlciBkZXRhaWxzIGluIHJlZ2lvbiAke3JlZ2lvbn1gKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHNzb0FkbWluQ2xpZW50LmRlc3Ryb3koKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gaWRjRGV0YWlscztcbn1cbjtcbmV4cG9ydCBkZWZhdWx0IGdldElkY0luZm87XG4iLCJpbXBvcnQgeyBPcmdhbml6YXRpb25zQ2xpZW50LCBEZXNjcmliZU9yZ2FuaXphdGlvbkNvbW1hbmQsIExpc3RSb290c0NvbW1hbmQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LW9yZ2FuaXphdGlvbnNcIjtcbmFzeW5jIGZ1bmN0aW9uIGdldE9yZ0RldGFpbHMocmVnaW9uKSB7XG4gICAgY29uc3Qgb3JnQ2xpZW50ID0gbmV3IE9yZ2FuaXphdGlvbnNDbGllbnQoeyByZWdpb24gfSk7XG4gICAgbGV0IG9yZ0RldGFpbHMgPSB7fTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBvcmdEZXNjcmliZUNvbW1hbmQgPSBuZXcgRGVzY3JpYmVPcmdhbml6YXRpb25Db21tYW5kKHt9KTtcbiAgICAgICAgY29uc3Qgb3JnRGF0YSA9IGF3YWl0IG9yZ0NsaWVudC5zZW5kKG9yZ0Rlc2NyaWJlQ29tbWFuZCk7XG4gICAgICAgIGlmIChvcmdEYXRhLk9yZ2FuaXphdGlvbikge1xuICAgICAgICAgICAgb3JnRGV0YWlscy5pZCA9IG9yZ0RhdGEuT3JnYW5pemF0aW9uLklkID8/IFwiXCI7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgT3JnYW5pemF0aW9uIElEOiAke29yZ0RldGFpbHMuaWR9YCApO1xuICAgICAgICAgICAgb3JnRGV0YWlscy5hcm4gPSBvcmdEYXRhLk9yZ2FuaXphdGlvbi5Bcm4gPz8gXCJcIjtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBPcmdhbml6YXRpb24gQVJOOiAke29yZ0RldGFpbHMuYXJufWApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgTGlzdFJvb3RzQ29tbWFuZCh7fSk7XG4gICAgICAgIGNvbnN0IHJvb3RzID0gYXdhaXQgb3JnQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gICAgICAgIGlmIChyb290cy5Sb290cykge1xuICAgICAgICAgICAgb3JnRGV0YWlscy5yb290T3VJZCA9IHJvb3RzLlJvb3RzWzBdLklkO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEFXUyBPcmcgcm9vdCBvdSBpZDogJHtvcmdEZXRhaWxzLnJvb3RPdUlkfWApXG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTm8gaW5mbyBmb3VuZCBmb3IgeW91ciBBV1MgT3JnYW5pemF0aW9uLicpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBBbiBlcnJvciBvY2N1cnJlZDogJHtlcnJvcn1gKTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIG9yZ0NsaWVudC5kZXN0cm95KCk7XG4gICAgICAgIHJldHVybiBvcmdEZXRhaWxzO1xuICAgIH1cbn1cbmV4cG9ydCBkZWZhdWx0IGdldE9yZ0RldGFpbHM7XG4iLCJpbXBvcnQgeyBPcmdhbml6YXRpb25zQ2xpZW50LCBMaXN0T3JnYW5pemF0aW9uYWxVbml0c0ZvclBhcmVudENvbW1hbmQsIExpc3RBY2NvdW50c0ZvclBhcmVudENvbW1hbmQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LW9yZ2FuaXphdGlvbnNcIjtcbmFzeW5jIGZ1bmN0aW9uIGdldE9yZ1RvcExldmVsT3VzKHJlZ2lvbiwgcm9vdE91SWQpIHtcbiAgICBjb25zdCBvcmdDbGllbnQgPSBuZXcgT3JnYW5pemF0aW9uc0NsaWVudCh7IHJlZ2lvbiB9KTtcbiAgICBsZXQgdG9wTGV2ZWxPdXMgPSBbXTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBsaXN0T1VzQ29tbWFuZCA9IG5ldyBMaXN0T3JnYW5pemF0aW9uYWxVbml0c0ZvclBhcmVudENvbW1hbmQoe1xuICAgICAgICAgICAgUGFyZW50SWQ6IHJvb3RPdUlkLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbGlzdE9Vc1Jlc3BvbnNlID0gYXdhaXQgb3JnQ2xpZW50LnNlbmQobGlzdE9Vc0NvbW1hbmQpO1xuICAgICAgICBpZiAobGlzdE9Vc1Jlc3BvbnNlLk9yZ2FuaXphdGlvbmFsVW5pdHMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgb3Ugb2YgbGlzdE9Vc1Jlc3BvbnNlLk9yZ2FuaXphdGlvbmFsVW5pdHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdG9wTGV2ZWxPdSA9IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IG91LklkLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBvdS5OYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjb25zdCBhY2NvdW50UmVzcG9uc2UgPSBhd2FpdCBvcmdDbGllbnQuc2VuZChuZXcgTGlzdEFjY291bnRzRm9yUGFyZW50Q29tbWFuZCh7IFBhcmVudElkOiBvdS5JZCB9KSk7XG4gICAgICAgICAgICAgICAgaWYgKGFjY291bnRSZXNwb25zZS5BY2NvdW50cyAmJiBhY2NvdW50UmVzcG9uc2UuQWNjb3VudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0b3BMZXZlbE91LmFjY291bnRzID0gYWNjb3VudFJlc3BvbnNlLkFjY291bnRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0b3BMZXZlbE91cy5wdXNoKHRvcExldmVsT3UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBzZXJ2aWNlIGFjY2VzczonLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIG9yZ0NsaWVudC5kZXN0cm95KCk7XG4gICAgfVxuICAgIHJldHVybiB0b3BMZXZlbE91cztcbn1cbjtcbmV4cG9ydCBkZWZhdWx0IGdldE9yZ1RvcExldmVsT3VzO1xuIiwiaW1wb3J0IHsgT3JnYW5pemF0aW9uc0NsaWVudCwgTGlzdEFjY291bnRzQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1vcmdhbml6YXRpb25zJztcbmFzeW5jIGZ1bmN0aW9uIGdldE9yZ01lbWJlckFjY291bnRzKCkge1xuICAgIGxldCBvcmdNZW1iZXJBY2NvdW50SW5mbyA9IFtdO1xuICAgIGNvbnN0IG9yZ3NDbGllbnQgPSBuZXcgT3JnYW5pemF0aW9uc0NsaWVudCh7IHJlZ2lvbjogJ3VzLWVhc3QtMScgfSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBvcmdzQ2xpZW50LnNlbmQobmV3IExpc3RBY2NvdW50c0NvbW1hbmQoe30pKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLkFjY291bnRzICYmIHJlc3BvbnNlLkFjY291bnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYWNjb3VudCBvZiByZXNwb25zZS5BY2NvdW50cykge1xuICAgICAgICAgICAgICAgIGxldCBvcmdNZW1iZXJBY2NvdW50ID0ge1xuICAgICAgICAgICAgICAgICAgICBhY2NvdW50TmFtZTogYWNjb3VudC5OYW1lLFxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50RW1haWw6IGFjY291bnQuRW1haWwsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBvcmdNZW1iZXJBY2NvdW50SW5mby5wdXNoKG9yZ01lbWJlckFjY291bnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsaXN0aW5nIEFXUyBhY2NvdW50czonLCBlcnJvcik7XG4gICAgfVxuICAgIGZpbmFsbHkge1xuICAgICAgICBvcmdzQ2xpZW50LmRlc3Ryb3koKTtcbiAgICB9XG4gICAgcmV0dXJuIG9yZ01lbWJlckFjY291bnRJbmZvO1xufVxuZXhwb3J0IGRlZmF1bHQgZ2V0T3JnTWVtYmVyQWNjb3VudHM7XG4iLCJpbXBvcnQgeyBJQU1DbGllbnQsIExpc3RVc2Vyc0NvbW1hbmQsIExpc3RBY2Nlc3NLZXlzQ29tbWFuZCwgR2V0QWNjZXNzS2V5TGFzdFVzZWRDb21tYW5kIH0gZnJvbSBcIkBhd3Mtc2RrL2NsaWVudC1pYW1cIjtcbi8vIGZ1bmN0aW9uIGxpc3QgYWxsIElBTSB1c2VycyBhbmQgaWYgdGhleSBoYXZlIGtleXMgaW4gdGhlIG1hbmFnZW1lbnQgYWNjb3VudFxuY29uc3QgY2hlY2tJYW1Vc2VycyA9IGFzeW5jICgpID0+IHtcbiAgICAvLyBTZXQgdG8gdXMtZWFzdC0xIGFzIElBTSBpcyBnbG9iYWwgYW5kIHJlZ2lvbiBpc24ndCBhIGNvbmNlcm5cbiAgICBjb25zdCBpYW1DbGllbnQgPSBuZXcgSUFNQ2xpZW50KHsgcmVnaW9uOiAndXMtZWFzdC0xJyB9KTtcbiAgICBjb25zdCBpYW1Vc2VySW5mbyA9IFtdO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGxpc3RVc2Vyc0NvbW1hbmQgPSBuZXcgTGlzdFVzZXJzQ29tbWFuZCh7fSk7XG4gICAgICAgIGNvbnN0IGxpc3RVc2Vyc1Jlc3BvbnNlID0gYXdhaXQgaWFtQ2xpZW50LnNlbmQobGlzdFVzZXJzQ29tbWFuZCk7XG4gICAgICAgIGZvciAoY29uc3QgdXNlciBvZiBsaXN0VXNlcnNSZXNwb25zZS5Vc2VycyB8fCBbXSkge1xuICAgICAgICAgICAgY29uc3QgdXNlck5hbWUgPSB1c2VyLlVzZXJOYW1lIHx8IFwiXCI7XG4gICAgICAgICAgICBjb25zdCBsaXN0QWNjZXNzS2V5c0NvbW1hbmQgPSBuZXcgTGlzdEFjY2Vzc0tleXNDb21tYW5kKHtcbiAgICAgICAgICAgICAgICBVc2VyTmFtZTogdXNlck5hbWUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IGxpc3RBY2Nlc3NLZXlzUmVzcG9uc2UgPSBhd2FpdCBpYW1DbGllbnQuc2VuZChsaXN0QWNjZXNzS2V5c0NvbW1hbmQpO1xuICAgICAgICAgICAgY29uc3QgYWNjZXNzS2V5cyA9IGxpc3RBY2Nlc3NLZXlzUmVzcG9uc2UuQWNjZXNzS2V5TWV0YWRhdGEgfHwgW107XG4gICAgICAgICAgICBpZiAoYWNjZXNzS2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBhY2Nlc3NLZXkgb2YgYWNjZXNzS2V5cykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBhY2Nlc3NLZXlJZCA9IGFjY2Vzc0tleS5BY2Nlc3NLZXlJZCB8fCBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBnZXRMYXN0VXNlZENvbW1hbmQgPSBuZXcgR2V0QWNjZXNzS2V5TGFzdFVzZWRDb21tYW5kKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEFjY2Vzc0tleUlkOiBhY2Nlc3NLZXlJZCxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxhc3RVc2VkUmVzcG9uc2UgPSBhd2FpdCBpYW1DbGllbnQuc2VuZChnZXRMYXN0VXNlZENvbW1hbmQpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmb3VuZFVzZXJJbmZvID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlck5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NLZXlJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3RVc2VkOiBsYXN0VXNlZFJlc3BvbnNlICYmIGxhc3RVc2VkUmVzcG9uc2UuQWNjZXNzS2V5TGFzdFVzZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IGAke2xhc3RVc2VkUmVzcG9uc2UuQWNjZXNzS2V5TGFzdFVzZWQuTGFzdFVzZWREYXRlfWAgfHwgXCJOb3QgYXZhaWxhYmxlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IFwiTm90IGF2YWlsYWJsZVwiLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpYW1Vc2VySW5mby5wdXNoKGZvdW5kVXNlckluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvdW5kVXNlckluZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpYW1Vc2VySW5mby5wdXNoKGZvdW5kVXNlckluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3I6XCIsIGVycm9yKTtcbiAgICB9XG4gICAgZmluYWxseSB7XG4gICAgICAgIGlhbUNsaWVudC5kZXN0cm95KCk7XG4gICAgfVxuICAgIHJldHVybiBpYW1Vc2VySW5mbztcbn07XG5leHBvcnQgZGVmYXVsdCBjaGVja0lhbVVzZXJzO1xuIiwiaW1wb3J0IHsgRUMyQ2xpZW50LCBEZXNjcmliZUluc3RhbmNlc0NvbW1hbmQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LWVjMlwiO1xuYXN5bmMgZnVuY3Rpb24gY2hlY2tFYzJFeGlzdHMocmVnaW9ucykge1xuICAgIGxldCBlYzJWYWxpZGF0aW9uID0gW107XG4gICAgZm9yIChjb25zdCByZWdpb24gb2YgcmVnaW9ucykge1xuICAgICAgICBjb25zdCBlYzJDbGllbnQgPSBuZXcgRUMyQ2xpZW50KHsgcmVnaW9uIH0pO1xuICAgICAgICBjb25zdCBjb21tYW5kID0gbmV3IERlc2NyaWJlSW5zdGFuY2VzQ29tbWFuZCh7fSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVjMkNsaWVudC5zZW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLlJlc2VydmF0aW9ucykge1xuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5SZXNlcnZhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGBXQVJOSU5HOiBJbnN0YW5jZShzKSBleGlzdHMgaW4gcmVnaW9uOiAke3JlZ2lvbn1gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWMyRm91bmQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb246IHJlZ2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGVjMkZvdW5kOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGVjMlZhbGlkYXRpb24ucHVzaChlYzJGb3VuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlYzJGb3VuZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZWMyRm91bmQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGVjMlZhbGlkYXRpb24ucHVzaChlYzJGb3VuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZWMyRm91bmQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICBlYzJGb3VuZDogZmFsc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGVjMlZhbGlkYXRpb24ucHVzaChlYzJGb3VuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgY2hlY2tpbmcgaW5zdGFuY2U6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBlYzJDbGllbnQuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfSAvLyBlbmQgZm9yXG4gICAgcmV0dXJuIGVjMlZhbGlkYXRpb247XG59XG47XG5leHBvcnQgZGVmYXVsdCBjaGVja0VjMkV4aXN0cztcbiIsImltcG9ydCB7IEVDMkNsaWVudCwgRGVzY3JpYmVWcGNzQ29tbWFuZCB9IGZyb20gXCJAYXdzLXNkay9jbGllbnQtZWMyXCI7XG5hc3luYyBmdW5jdGlvbiBjaGVja1ZwY0V4aXN0cyhyZWdpb25zKSB7XG4gICAgbGV0IHZwY1ZhbGlkYXRpb24gPSBbXTtcbiAgICBmb3IgKGNvbnN0IHJlZ2lvbiBvZiByZWdpb25zKSB7XG4gICAgICAgIGNvbnN0IGVjMkNsaWVudCA9IG5ldyBFQzJDbGllbnQoeyByZWdpb24gfSk7XG4gICAgICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgRGVzY3JpYmVWcGNzQ29tbWFuZCh7fSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGVjMkNsaWVudC5zZW5kKGNvbW1hbmQpO1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLlZwY3MpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuVnBjcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYFdBUk5JTkc6IFZQQyhzKSBleGlzdHMgaW4gcmVnaW9uOiAke3JlZ2lvbn1gKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdnBjRm91bmQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWdpb246IHJlZ2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHZwY0ZvdW5kOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZwY1ZhbGlkYXRpb24ucHVzaCh2cGNGb3VuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2cGNGb3VuZCA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgdnBjRm91bmQ6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZwY1ZhbGlkYXRpb24ucHVzaCh2cGNGb3VuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdnBjRm91bmQgPSB7XG4gICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICB2cGNGb3VuZDogZmFsc2VcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHZwY1ZhbGlkYXRpb24ucHVzaCh2cGNGb3VuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3IgY2hlY2tpbmcgaW5zdGFuY2U6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBlYzJDbGllbnQuZGVzdHJveSgpO1xuICAgICAgICB9XG4gICAgfSAvLyBlbmQgZm9yXG4gICAgcmV0dXJuIHZwY1ZhbGlkYXRpb247XG59XG47XG5leHBvcnQgZGVmYXVsdCBjaGVja1ZwY0V4aXN0cztcbiIsImltcG9ydCB7IENsb3VkVHJhaWxDbGllbnQsIERlc2NyaWJlVHJhaWxzQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1jbG91ZHRyYWlsJztcbmFzeW5jIGZ1bmN0aW9uIGNoZWNrQ2xvdWRUcmFpbEV4aXN0cyhyZWdpb25zKSB7XG4gICAgbGV0IGNsb3VkVHJhaWxWYWxpZGF0aW9uID0gW107XG4gICAgZm9yIChjb25zdCByZWdpb24gb2YgcmVnaW9ucykge1xuICAgICAgICBjb25zdCBjbG91ZFRyYWlsQ2xpZW50ID0gbmV3IENsb3VkVHJhaWxDbGllbnQoeyByZWdpb24gfSk7XG4gICAgICAgIGNvbnN0IGNsb3VkVHJhaWxEZXNjcmliZUNvbW1hbmQgPSBuZXcgRGVzY3JpYmVUcmFpbHNDb21tYW5kKHt9KTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNsb3VkVHJhaWxSZXNwb25zZSA9IGF3YWl0IGNsb3VkVHJhaWxDbGllbnQuc2VuZChjbG91ZFRyYWlsRGVzY3JpYmVDb21tYW5kKTtcbiAgICAgICAgICAgIGlmIChjbG91ZFRyYWlsUmVzcG9uc2UudHJhaWxMaXN0KSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0cmFpbCBvZiBjbG91ZFRyYWlsUmVzcG9uc2UudHJhaWxMaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCB0cmFpbEluZm8gPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWlsLkhvbWVSZWdpb24gPT0gcmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGB0cmFpbCBmb3VuZCBpbiAke3JlZ2lvbn1gKVxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhaWxJbmZvID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYWlsRm91bmQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNPcmdUcmFpbDogdHJhaWwuSXNNdWx0aVJlZ2lvblRyYWlsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTXVsdGlSZWdpb246IHRyYWlsLklzTXVsdGlSZWdpb25UcmFpbFxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYWlsSW5mbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWdpb246IHJlZ2lvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFpbEZvdW5kOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjbG91ZFRyYWlsVmFsaWRhdGlvbi5wdXNoKHRyYWlsSW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coYEVycm9yIGNoZWNraW5nIGluc3RhbmNlOiAke2Vycm9yfWApO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgY2xvdWRUcmFpbENsaWVudC5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9IC8vIGVuZCBmb3IgcmVnaW9uc1xuICAgIHJldHVybiBjbG91ZFRyYWlsVmFsaWRhdGlvbjtcbn1cbjtcbmV4cG9ydCBkZWZhdWx0IGNoZWNrQ2xvdWRUcmFpbEV4aXN0cztcbiIsImltcG9ydCB7IENvbmZpZ1NlcnZpY2VDbGllbnQsIERlc2NyaWJlQ29uZmlndXJhdGlvblJlY29yZGVyU3RhdHVzQ29tbWFuZCwgRGVzY3JpYmVEZWxpdmVyeUNoYW5uZWxzQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1jb25maWctc2VydmljZSc7XG5hc3luYyBmdW5jdGlvbiBjaGVja0NvbmZpZ0V4aXN0cyhyZWdpb25zKSB7XG4gICAgbGV0IGNvbmZpZ0RldGFpbHMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IHJlZ2lvbiBvZiByZWdpb25zKSB7XG4gICAgICAgIGNvbnN0IGNvbmZpZ1NlcnZpY2VDbGllbnQgPSBuZXcgQ29uZmlnU2VydmljZUNsaWVudCh7IHJlZ2lvbiB9KTtcbiAgICAgICAgbGV0IGNvbmZpZ0RldGFpbCA9IHtcbiAgICAgICAgICAgIHJlZ2lvbjogcmVnaW9uLFxuICAgICAgICAgICAgY29uZmlnUmVjb3JkZXJGb3VuZDogZmFsc2UsXG4gICAgICAgICAgICBjb25maWdEZWxpdmVyeUNoYW5uZWxGb3VuZDogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIENvbmZpZyByZWNvcmRlciBleGlzdHNcbiAgICAgICAgICAgIGNvbnN0IHJlY29yZGVyUmVzcG9uc2UgPSBhd2FpdCBjb25maWdTZXJ2aWNlQ2xpZW50LnNlbmQobmV3IERlc2NyaWJlQ29uZmlndXJhdGlvblJlY29yZGVyU3RhdHVzQ29tbWFuZCh7fSkpO1xuICAgICAgICAgICAgY29uc3QgcmVjb3JkZXJFeGlzdHMgPSByZWNvcmRlclJlc3BvbnNlLkNvbmZpZ3VyYXRpb25SZWNvcmRlcnNTdGF0dXM/Lmxlbmd0aCAhPT0gMDtcbiAgICAgICAgICAgIGlmIChyZWNvcmRlckV4aXN0cykge1xuICAgICAgICAgICAgICAgIGNvbmZpZ0RldGFpbC5jb25maWdSZWNvcmRlckZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIENvbmZpZyBkZWxpdmVyeSBjaGFubmVsIGV4aXN0c1xuICAgICAgICAgICAgY29uc3QgY2hhbm5lbFJlc3BvbnNlID0gYXdhaXQgY29uZmlnU2VydmljZUNsaWVudC5zZW5kKG5ldyBEZXNjcmliZURlbGl2ZXJ5Q2hhbm5lbHNDb21tYW5kKHt9KSk7XG4gICAgICAgICAgICBjb25zdCBjaGFubmVsRXhpc3RzID0gY2hhbm5lbFJlc3BvbnNlLkRlbGl2ZXJ5Q2hhbm5lbHM/Lmxlbmd0aCAhPT0gMDtcbiAgICAgICAgICAgIGlmIChjaGFubmVsRXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgY29uZmlnRGV0YWlsLmNvbmZpZ0RlbGl2ZXJ5Q2hhbm5lbEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbmZpZ0RldGFpbHMucHVzaChjb25maWdEZXRhaWwpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgY2hlY2tpbmcgQVdTIENvbmZpZyBpbiAke3JlZ2lvbn06YCwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgY29uZmlnU2VydmljZUNsaWVudC5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvbmZpZ0RldGFpbHM7XG59XG5leHBvcnQgZGVmYXVsdCBjaGVja0NvbmZpZ0V4aXN0cztcbiJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiYXN5bmMiLCJyZXBvcnRGaWxlIiwiZGF0ZVRpbWUiLCJEYXRlIiwidG9VVENTdHJpbmciLCJyZWdpb24iLCJwcm9jZXNzIiwiZW52IiwiQVdTX1JFR0lPTiIsImFsbFJlZ2lvbnMiLCJlYzJDbGllbnQiLCJFQzJDbGllbnQiLCJkZXNjcmliZVJlZ2lvbnNDb21tYW5kIiwiRGVzY3JpYmVSZWdpb25zQ29tbWFuZCIsInJlc3BvbnNlIiwic2VuZCIsInJlZ2lvbnMiLCJSZWdpb25zIiwicHVzaCIsIlJlZ2lvbk5hbWUiLCJlcnJvciIsImNvbnNvbGUiLCJkZXN0cm95IiwiYWNjb3VudFR5cGUiLCJvcmdhbml6YXRpb25zQ2xpZW50IiwiT3JnYW5pemF0aW9uc0NsaWVudCIsImRlc2NyaWJlT3JnYW5pemF0aW9uQ29tbWFuZCIsIkRlc2NyaWJlT3JnYW5pemF0aW9uQ29tbWFuZCIsImRlc2NyaWJlT3JnYW5pemF0aW9uUmVzcG9uc2UiLCJpc0luT3JnYW5pemF0aW9uIiwiT3JnYW5pemF0aW9uIiwiTWFzdGVyQWNjb3VudElkIiwiaXNNYW5hZ2VtZW50QWNjb3VudCIsImRlZmluZUFjY291bnRUeXBlIiwiZGlyIiwiZGVwdGgiLCJjb2xvcnMiLCJsZWdhY3lDdXJDaGVjayIsImN1ckNsaWVudCIsIkNvc3RBbmRVc2FnZVJlcG9ydFNlcnZpY2VDbGllbnQiLCJpc0xlZ2FjeUN1clNldHVwIiwiaW5wdXQiLCJjb21tYW5kIiwiRGVzY3JpYmVSZXBvcnREZWZpbml0aW9uc0NvbW1hbmQiLCJSZXBvcnREZWZpbml0aW9ucyIsImxlbmd0aCIsImVuYWJsZU9yZ1BvbGljaWVzQ2hlY2siLCJvcmdDbGllbnQiLCJwb2xpY3lUeXBlc0VuYWJsZWQiLCJzY3BFbmFibGVkIiwidGFnUG9saWN5RW5hYmxlZCIsImJhY2t1cFBvbGljeUVuYWJsZWQiLCJMaXN0Um9vdHNDb21tYW5kIiwicm9vdHMiLCJSb290cyIsIlBvbGljeVR5cGVzIiwiZW5hYmxlZFBvbGljeSIsIlR5cGUiLCJTdGF0dXMiLCJvcmdFbmFibGVkU2VydmljZXMiLCJkaXNjb3ZlcmVkT3JnU2VydmljZXMiLCJvcmdTZXJ2aWNlQWNjZXNzQ29tbWFuZCIsIkxpc3RBV1NTZXJ2aWNlQWNjZXNzRm9yT3JnYW5pemF0aW9uQ29tbWFuZCIsIm9yZ1NlcnZpY2VBY2Nlc3NSZXNwb25zZSIsIkVuYWJsZWRTZXJ2aWNlUHJpbmNpcGFscyIsIm9yZ1NlcnZpY2UiLCJmb3VuZE9yZ1NlcnZpY2UiLCJzZXJ2aWNlIiwiU2VydmljZVByaW5jaXBhbCIsIm9yZ0RlbEFkbWluRGV0YWlscyIsIm9yZ0RhRGV0YWlscyIsIm9yZ0RhRGV0YWlsIiwiTGlzdERlbGVnYXRlZEFkbWluaXN0cmF0b3JzQ29tbWFuZCIsIkRlbGVnYXRlZEFkbWluaXN0cmF0b3JzIiwiZGEiLCJBY2NvdW50SWQiLCJJZCIsIkxpc3REZWxlZ2F0ZWRTZXJ2aWNlc0ZvckFjY291bnRDb21tYW5kIiwiYWNjb3VudFJlc3BvbnNlIiwiRGVsZWdhdGVkU2VydmljZXMiLCJzZXJ2aWNlcyIsImFjY291bnROYW1lIiwiTmFtZSIsImxvZyIsImFjY291bnQiLCJzcnYiLCJjZm5PcmdTdGF0dXMiLCJvcmdDZm5TdGF0dXMiLCJzdGF0dXMiLCJjbG91ZEZvcm1hdGlvbkNsaWVudCIsIkNsb3VkRm9ybWF0aW9uQ2xpZW50IiwiZGVzY3JpYmVPcmdBY2Nlc3NJbnB1dCIsIkRlc2NyaWJlT3JnYW5pemF0aW9uc0FjY2Vzc0NvbW1hbmQiLCJjbG91ZEZvcm1hdGlvbk9yZ0FjY2VzcyIsImNvbnRyb2xUb3dlckRldGFpbHMiLCJjb250cm9sVG93ZXJJbmZvIiwiY29udHJvbFRvd2VyQ2xpZW50IiwiQ29udHJvbFRvd2VyQ2xpZW50IiwiTGlzdExhbmRpbmdab25lc0NvbW1hbmQiLCJKU09OIiwic3RyaW5naWZ5IiwibGFuZGluZ1pvbmVzIiwibGFuZGluZ1pvbmVJZGVudGlmaWVyIiwiYXJuIiwibHpSZWdpb24iLCJ0b1N0cmluZyIsInNwbGl0IiwiY29udHJvbFRvd2VyUmVnaW9uIiwiY29udHJvbFRvd2VyQ2xpZW50UmVnaW9uIiwiR2V0TGFuZGluZ1pvbmVDb21tYW5kIiwibHpSZXNwb25zZSIsImxhbmRpbmdab25lIiwibGF0ZXN0QXZhaWxhYmxlVmVyc2lvbiIsImRlcGxveWVkVmVyc2lvbiIsInZlcnNpb24iLCJkcmlmdFN0YXR1cyIsImlkY0luZm9ybWF0aW9uIiwicmVnaW9uTGlzdCIsImlkY0RldGFpbHMiLCJmb3VuZCIsInNzb0FkbWluQ2xpZW50IiwiU1NPQWRtaW5DbGllbnQiLCJzc29JbnB1dCIsIk1heFJlc3VsdHMiLCJOdW1iZXIiLCJMaXN0SW5zdGFuY2VzQ29tbWFuZCIsInNzb0luc3RhbmNlUmVzcG9uc2UiLCJJbnN0YW5jZXMiLCJzc29JbnN0YW5jZSIsIkluc3RhbmNlQXJuIiwiaWQiLCJJZGVudGl0eVN0b3JlSWQiLCJvcmdEZXRhaWxzIiwib3JnRGVzY3JpYmVDb21tYW5kIiwib3JnRGF0YSIsIkFybiIsInJvb3RPdUlkIiwib3JnT3VzIiwidG9wTGV2ZWxPdXMiLCJsaXN0T1VzQ29tbWFuZCIsIkxpc3RPcmdhbml6YXRpb25hbFVuaXRzRm9yUGFyZW50Q29tbWFuZCIsIlBhcmVudElkIiwibGlzdE9Vc1Jlc3BvbnNlIiwiT3JnYW5pemF0aW9uYWxVbml0cyIsIm91IiwidG9wTGV2ZWxPdSIsIm5hbWUiLCJMaXN0QWNjb3VudHNGb3JQYXJlbnRDb21tYW5kIiwiQWNjb3VudHMiLCJhY2NvdW50cyIsIm9yZ01lbWJlckFjY291bnREZXRhaWxzIiwib3JnTWVtYmVyQWNjb3VudEluZm8iLCJvcmdzQ2xpZW50IiwiTGlzdEFjY291bnRzQ29tbWFuZCIsIm9yZ01lbWJlckFjY291bnQiLCJhY2NvdW50RW1haWwiLCJFbWFpbCIsIm1lbWJlckFjY291bnQiLCJtZXNzYWdlIiwid2FybiIsImlhbVVzZXJSZXN1bHQiLCJpYW1DbGllbnQiLCJJQU1DbGllbnQiLCJpYW1Vc2VySW5mbyIsImxpc3RVc2Vyc0NvbW1hbmQiLCJMaXN0VXNlcnNDb21tYW5kIiwibGlzdFVzZXJzUmVzcG9uc2UiLCJ1c2VyIiwiVXNlcnMiLCJ1c2VyTmFtZSIsIlVzZXJOYW1lIiwibGlzdEFjY2Vzc0tleXNDb21tYW5kIiwiTGlzdEFjY2Vzc0tleXNDb21tYW5kIiwiYWNjZXNzS2V5cyIsIkFjY2Vzc0tleU1ldGFkYXRhIiwiYWNjZXNzS2V5IiwiYWNjZXNzS2V5SWQiLCJBY2Nlc3NLZXlJZCIsImdldExhc3RVc2VkQ29tbWFuZCIsIkdldEFjY2Vzc0tleUxhc3RVc2VkQ29tbWFuZCIsImxhc3RVc2VkUmVzcG9uc2UiLCJmb3VuZFVzZXJJbmZvIiwibGFzdFVzZWQiLCJBY2Nlc3NLZXlMYXN0VXNlZCIsIkxhc3RVc2VkRGF0ZSIsImlhbVVzZXIiLCJlYzJDaGVjayIsImVjMlZhbGlkYXRpb24iLCJEZXNjcmliZUluc3RhbmNlc0NvbW1hbmQiLCJSZXNlcnZhdGlvbnMiLCJlYzJGb3VuZCIsImZpbmQiLCJwYXJhbSIsImVjMiIsInZwY0NoZWNrIiwidnBjVmFsaWRhdGlvbiIsIkRlc2NyaWJlVnBjc0NvbW1hbmQiLCJWcGNzIiwidnBjRm91bmQiLCJ2cGNGaW5kIiwiY2xvdWRUcmFpbENoZWNrIiwiY2xvdWRUcmFpbFZhbGlkYXRpb24iLCJjbG91ZFRyYWlsQ2xpZW50IiwiQ2xvdWRUcmFpbENsaWVudCIsImNsb3VkVHJhaWxEZXNjcmliZUNvbW1hbmQiLCJEZXNjcmliZVRyYWlsc0NvbW1hbmQiLCJjbG91ZFRyYWlsUmVzcG9uc2UiLCJ0cmFpbExpc3QiLCJ0cmFpbCIsInRyYWlsSW5mbyIsIkhvbWVSZWdpb24iLCJ0cmFpbEZvdW5kIiwiaXNPcmdUcmFpbCIsIklzTXVsdGlSZWdpb25UcmFpbCIsImlzTXVsdGlSZWdpb24iLCJjdEZpbmQiLCJjb25maWdDaGVjayIsImNvbmZpZ0RldGFpbHMiLCJjb25maWdTZXJ2aWNlQ2xpZW50IiwiQ29uZmlnU2VydmljZUNsaWVudCIsImNvbmZpZ0RldGFpbCIsImNvbmZpZ1JlY29yZGVyRm91bmQiLCJjb25maWdEZWxpdmVyeUNoYW5uZWxGb3VuZCIsInJlY29yZGVyUmVzcG9uc2UiLCJEZXNjcmliZUNvbmZpZ3VyYXRpb25SZWNvcmRlclN0YXR1c0NvbW1hbmQiLCJDb25maWd1cmF0aW9uUmVjb3JkZXJzU3RhdHVzIiwiY2hhbm5lbFJlc3BvbnNlIiwiRGVzY3JpYmVEZWxpdmVyeUNoYW5uZWxzQ29tbWFuZCIsIkRlbGl2ZXJ5Q2hhbm5lbHMiLCJjb25maWdGaW5kIiwibWFpbiJdLCJzb3VyY2VSb290IjoiIn0=